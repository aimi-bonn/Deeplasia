23 Jun 22 12:05:52	INFO	testing.py	====== Testing model =====
23 Jun 22 12:05:52	INFO	testing.py	Starting inference
23 Jun 22 12:07:04	INFO	seed.py	Global seed set to 42
23 Jun 22 12:07:04	INFO	datasets.py	found 12610 train images
23 Jun 22 12:07:04	INFO	datasets.py	found 1425 val images
23 Jun 22 12:07:04	INFO	datasets.py	found 200 test images
23 Jun 22 12:07:04	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 12:07:04	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 12:07:06	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 12:07:07	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 12:07:07	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 12:07:07	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 12:07:07	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 12:07:07	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 12:07:08	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 12:07:08	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 12:07:08	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 12:07:08	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 12:07:08	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 12:07:08	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 12:07:08	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 12:07:08	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 12:07:08	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 12:07:08	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 12:07:08	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 12:07:08	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 12:07:08	INFO	cli.py	Output directory set to output/debug/version_65
23 Jun 22 12:07:08	INFO	log.py	Logs saved to run.log
23 Jun 22 12:07:08	INFO	log.py	Core count             = 12
23 Jun 22 12:07:08	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 12:07:08	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 12:07:08	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 12:07:08	INFO	log.py	CUDA version           = 11.3
23 Jun 22 12:07:08	INFO	log.py	CUDA count             = 1
23 Jun 22 12:07:08	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 12:07:19	INFO	train_model.py	========== start training ==========
23 Jun 22 12:07:21	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 12:07:21	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | EfficientnetMaxPool | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork        | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | age_loss | MSELoss             | 0      | ?                   | ?               
3 | sex_loss | BCEWithLogitsLoss   | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 12:07:21	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetMaxPool     | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | age_loss                   | MSELoss                 | 0      | ?                   | ?                
24 | sex_loss                   | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 12:08:54	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 0.917
23 Jun 22 12:08:54	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached 0.91693 (best 0.91693), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_65/ckp/best_model.ckpt' as top 1
23 Jun 22 12:09:07	INFO	cli.py	===== Training finished ======
23 Jun 22 12:09:07	INFO	cli.py	Training time : 1.80min for 112 steps of training
23 Jun 22 12:09:07	INFO	cli.py	Training speed: 1.04 steps/second
23 Jun 22 12:09:26	INFO	train_model.py	========== Testing model ==========
23 Jun 22 12:09:29	INFO	cli.py	Using last obtained model
23 Jun 22 12:09:53	INFO	testing.py	====== Testing model =====
23 Jun 22 12:10:25	INFO	testing.py	Starting inference
23 Jun 22 12:15:31	INFO	seed.py	Global seed set to 42
23 Jun 22 12:15:31	INFO	datasets.py	found 12610 train images
23 Jun 22 12:15:31	INFO	datasets.py	found 1425 val images
23 Jun 22 12:15:31	INFO	datasets.py	found 200 test images
23 Jun 22 12:15:31	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 12:15:31	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 12:15:33	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 12:15:34	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 12:15:34	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 12:15:34	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 12:15:34	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 12:15:34	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 12:15:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 12:15:35	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 12:15:35	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 12:15:35	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 12:15:35	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 12:15:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 12:15:35	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 12:15:35	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 12:15:35	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 12:15:35	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 12:15:35	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 12:15:35	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 12:15:35	INFO	cli.py	Output directory set to output/debug/version_66
23 Jun 22 12:15:35	INFO	log.py	Logs saved to run.log
23 Jun 22 12:15:35	INFO	log.py	Core count             = 12
23 Jun 22 12:15:35	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 12:15:35	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 12:15:35	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 12:15:35	INFO	log.py	CUDA version           = 11.3
23 Jun 22 12:15:35	INFO	log.py	CUDA count             = 1
23 Jun 22 12:15:35	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 12:15:43	INFO	train_model.py	========== start training ==========
23 Jun 22 12:16:26	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 12:16:26	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | EfficientnetMaxPool | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork        | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | age_loss | MSELoss             | 0      | ?                   | ?               
3 | sex_loss | BCEWithLogitsLoss   | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 12:16:26	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetMaxPool     | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | age_loss                   | MSELoss                 | 0      | ?                   | ?                
24 | sex_loss                   | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 12:17:58	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 0.944
23 Jun 22 12:17:58	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached 0.94386 (best 0.94386), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_66/ckp/best_model.ckpt' as top 1
23 Jun 22 12:18:00	INFO	cli.py	===== Training finished ======
23 Jun 22 12:18:00	INFO	cli.py	Training time : 1.61min for 100 steps of training
23 Jun 22 12:18:00	INFO	cli.py	Training speed: 1.04 steps/second
23 Jun 22 12:18:47	INFO	train_model.py	========== Testing model ==========
23 Jun 22 12:18:47	INFO	cli.py	Using last obtained model
23 Jun 22 12:18:47	INFO	testing.py	====== Testing model =====
23 Jun 22 12:18:47	INFO	testing.py	Starting inference
23 Jun 22 12:18:48	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_66/ckp/last.ckpt
23 Jun 22 12:26:11	INFO	seed.py	Global seed set to 42
23 Jun 22 12:26:11	INFO	datasets.py	found 12610 train images
23 Jun 22 12:26:11	INFO	datasets.py	found 1425 val images
23 Jun 22 12:26:11	INFO	datasets.py	found 200 test images
23 Jun 22 12:26:11	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 12:26:11	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 12:26:12	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 12:26:14	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 12:26:14	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 12:26:14	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 12:26:14	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 12:26:14	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 12:26:14	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 12:26:14	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 12:26:14	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 12:26:14	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 12:26:14	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 12:26:14	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 12:26:14	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 12:26:15	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 12:26:15	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 12:26:15	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 12:26:15	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 12:26:15	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 12:26:15	INFO	cli.py	Output directory set to output/debug/version_67
23 Jun 22 12:26:15	INFO	log.py	Logs saved to run.log
23 Jun 22 12:26:15	INFO	log.py	Core count             = 12
23 Jun 22 12:26:15	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 12:26:15	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 12:26:15	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 12:26:15	INFO	log.py	CUDA version           = 11.3
23 Jun 22 12:26:15	INFO	log.py	CUDA count             = 1
23 Jun 22 12:26:15	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 12:26:25	INFO	train_model.py	========== start training ==========
23 Jun 22 12:26:28	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 12:26:28	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | EfficientnetMaxPool | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork        | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | age_loss | MSELoss             | 0      | ?                   | ?               
3 | sex_loss | BCEWithLogitsLoss   | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 12:26:28	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetMaxPool     | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | age_loss                   | MSELoss                 | 0      | ?                   | ?                
24 | sex_loss                   | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 12:28:00	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 0.929
23 Jun 22 12:28:00	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached 0.92899 (best 0.92899), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_67/ckp/best_model.ckpt' as top 1
23 Jun 22 12:28:02	INFO	cli.py	===== Training finished ======
23 Jun 22 12:28:02	INFO	cli.py	Training time : 1.61min for 100 steps of training
23 Jun 22 12:28:02	INFO	cli.py	Training speed: 1.03 steps/second
23 Jun 22 12:29:13	INFO	train_model.py	========== Testing model ==========
23 Jun 22 12:29:13	INFO	cli.py	Using last obtained model
23 Jun 22 12:29:13	INFO	testing.py	====== Testing model =====
23 Jun 22 12:29:13	INFO	testing.py	Starting inference
23 Jun 22 12:29:14	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_67/ckp/last.ckpt
23 Jun 22 12:32:35	INFO	seed.py	Global seed set to 42
23 Jun 22 12:32:35	INFO	datasets.py	found 12610 train images
23 Jun 22 12:32:35	INFO	datasets.py	found 1425 val images
23 Jun 22 12:32:35	INFO	datasets.py	found 200 test images
23 Jun 22 12:32:35	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 12:32:35	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 12:32:37	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 12:32:38	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 12:32:38	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 12:32:38	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 12:32:38	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 12:32:38	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 12:32:39	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 12:32:39	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 12:32:39	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 12:32:39	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 12:32:39	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 12:32:39	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 12:32:39	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 12:32:39	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 12:32:39	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 12:32:39	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 12:32:39	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 12:32:39	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 12:32:39	INFO	cli.py	Output directory set to output/debug/version_68
23 Jun 22 12:32:39	INFO	log.py	Logs saved to run.log
23 Jun 22 12:32:39	INFO	log.py	Core count             = 12
23 Jun 22 12:32:39	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 12:32:39	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 12:32:39	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 12:32:39	INFO	log.py	CUDA version           = 11.3
23 Jun 22 12:32:39	INFO	log.py	CUDA count             = 1
23 Jun 22 12:32:39	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 12:32:50	INFO	train_model.py	========== start training ==========
23 Jun 22 12:32:52	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 12:32:52	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | EfficientnetMaxPool | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork        | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | age_loss | MSELoss             | 0      | ?                   | ?               
3 | sex_loss | BCEWithLogitsLoss   | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 12:32:52	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetMaxPool     | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | age_loss                   | MSELoss                 | 0      | ?                   | ?                
24 | sex_loss                   | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 12:34:24	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 0.905
23 Jun 22 12:34:24	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached 0.90491 (best 0.90491), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_68/ckp/best_model.ckpt' as top 1
23 Jun 22 12:34:26	INFO	cli.py	===== Training finished ======
23 Jun 22 12:34:26	INFO	cli.py	Training time : 1.61min for 100 steps of training
23 Jun 22 12:34:26	INFO	cli.py	Training speed: 1.04 steps/second
23 Jun 22 12:34:26	INFO	train_model.py	========== Testing model ==========
23 Jun 22 12:34:26	INFO	cli.py	Using last obtained model
23 Jun 22 12:34:26	INFO	testing.py	====== Testing model =====
23 Jun 22 12:34:26	INFO	testing.py	Starting inference
23 Jun 22 12:34:27	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_68/ckp/last.ckpt
23 Jun 22 15:44:11	INFO	seed.py	Global seed set to 42
23 Jun 22 15:44:12	INFO	datasets.py	found 12610 train images
23 Jun 22 15:44:12	INFO	datasets.py	found 1425 val images
23 Jun 22 15:44:12	INFO	datasets.py	found 200 test images
23 Jun 22 15:44:12	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 15:44:12	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:44:13	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 15:44:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 15:44:15	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 15:44:15	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 15:44:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:44:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 15:44:16	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 15:44:16	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 15:44:16	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 15:44:16	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:44:16	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 15:44:16	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 15:44:16	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 15:44:16	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 15:44:16	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 15:44:16	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 15:44:16	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 15:44:16	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 15:44:16	INFO	cli.py	Output directory set to output/debug/version_69
23 Jun 22 15:44:16	INFO	log.py	Logs saved to run.log
23 Jun 22 15:44:16	INFO	log.py	Core count             = 12
23 Jun 22 15:44:16	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 15:44:16	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 15:44:16	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 15:44:16	INFO	log.py	CUDA version           = 11.3
23 Jun 22 15:44:16	INFO	log.py	CUDA count             = 1
23 Jun 22 15:44:16	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 15:44:22	INFO	seed.py	Global seed set to 42
23 Jun 22 15:44:22	INFO	datasets.py	found 12610 train images
23 Jun 22 15:44:22	INFO	datasets.py	found 1425 val images
23 Jun 22 15:44:22	INFO	datasets.py	found 200 test images
23 Jun 22 15:44:22	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 15:44:22	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:44:24	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 15:44:26	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 15:44:26	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 15:44:26	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 15:44:26	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:44:26	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 15:44:26	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 15:44:26	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 15:44:26	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 15:44:26	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:44:26	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 15:44:26	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 15:44:26	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 15:44:26	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 15:44:26	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 15:44:26	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 15:44:26	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 15:44:26	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 15:44:26	INFO	cli.py	Output directory set to output/debug/version_70
23 Jun 22 15:44:26	INFO	log.py	Logs saved to run.log
23 Jun 22 15:44:26	INFO	log.py	Core count             = 12
23 Jun 22 15:44:26	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 15:44:26	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 15:44:26	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 15:44:26	INFO	log.py	CUDA version           = 11.3
23 Jun 22 15:44:26	INFO	log.py	CUDA count             = 1
23 Jun 22 15:44:26	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 15:44:34	INFO	train_model.py	========== start training ==========
23 Jun 22 15:45:18	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 15:45:18	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | EfficientnetMaxPool | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork        | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | age_loss | MSELoss             | 0      | ?                   | ?               
3 | sex_loss | BCEWithLogitsLoss   | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 15:45:18	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetMaxPool     | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | age_loss                   | MSELoss                 | 0      | ?                   | ?                
24 | sex_loss                   | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 15:46:51	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 0.931
23 Jun 22 15:46:51	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached 0.93059 (best 0.93059), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_70/ckp/best_model.ckpt' as top 1
23 Jun 22 15:46:54	INFO	cli.py	===== Training finished ======
23 Jun 22 15:46:54	INFO	cli.py	Training time : 1.64min for 100 steps of training
23 Jun 22 15:46:54	INFO	cli.py	Training speed: 1.02 steps/second
23 Jun 22 15:46:54	INFO	train_model.py	========== Testing model ==========
23 Jun 22 15:46:54	INFO	cli.py	Using last obtained model
23 Jun 22 15:46:54	INFO	testing.py	====== Testing model =====
23 Jun 22 15:46:54	INFO	testing.py	Starting inference
23 Jun 22 15:46:54	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_70/ckp/last.ckpt
23 Jun 22 15:47:29	INFO	testing.py	normalizing images with: zscore
23 Jun 22 15:47:54	INFO	testing.py	normalizing images with: zscore
23 Jun 22 15:48:59	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:49:00	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 15158 / 15186
23 Jun 22 15:49:01	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 15186
23 Jun 22 15:49:01	INFO	datasets.py	Number of masks available from all sources combined : 15183 / 15186
23 Jun 22 15:52:24	INFO	seed.py	Global seed set to 42
23 Jun 22 15:52:24	INFO	datasets.py	found 12610 train images
23 Jun 22 15:52:24	INFO	datasets.py	found 1425 val images
23 Jun 22 15:52:24	INFO	datasets.py	found 200 test images
23 Jun 22 15:52:24	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 15:52:24	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:52:25	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 15:52:27	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 15:52:27	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 15:52:27	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 15:52:27	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:52:27	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 15:52:27	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 15:52:27	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 15:52:27	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 15:52:27	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:52:27	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 15:52:27	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 15:52:27	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 15:52:28	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 15:52:28	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 15:52:28	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 15:52:28	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 15:52:28	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 15:52:28	INFO	cli.py	Output directory set to output/debug/version_71
23 Jun 22 15:52:28	INFO	log.py	Logs saved to run.log
23 Jun 22 15:52:28	INFO	log.py	Core count             = 12
23 Jun 22 15:52:28	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 15:52:28	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 15:52:28	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 15:52:28	INFO	log.py	CUDA version           = 11.3
23 Jun 22 15:52:28	INFO	log.py	CUDA count             = 1
23 Jun 22 15:52:28	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 15:52:36	INFO	train_model.py	========== start training ==========
23 Jun 22 15:52:40	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 15:52:40	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | EfficientnetMaxPool | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork        | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | age_loss | MSELoss             | 0      | ?                   | ?               
3 | sex_loss | BCEWithLogitsLoss   | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 15:52:40	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetMaxPool     | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | age_loss                   | MSELoss                 | 0      | ?                   | ?                
24 | sex_loss                   | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 15:53:01	INFO	cli.py	===== Training finished ======
23 Jun 22 15:53:01	INFO	cli.py	Training time : 0.39min for 14 steps of training
23 Jun 22 15:53:01	INFO	cli.py	Training speed: 0.59 steps/second
23 Jun 22 15:53:01	INFO	train_model.py	========== Testing model ==========
23 Jun 22 15:53:01	INFO	cli.py	Using last obtained model
23 Jun 22 15:53:01	INFO	testing.py	====== Testing model =====
23 Jun 22 15:53:01	INFO	testing.py	Starting inference
23 Jun 22 15:53:07	INFO	seed.py	Global seed set to 42
23 Jun 22 15:53:07	INFO	datasets.py	found 12610 train images
23 Jun 22 15:53:07	INFO	datasets.py	found 1425 val images
23 Jun 22 15:53:07	INFO	datasets.py	found 200 test images
23 Jun 22 15:53:07	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 15:53:07	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:53:09	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 15:53:10	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 15:53:10	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 15:53:10	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 15:53:10	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:53:10	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 15:53:11	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 15:53:11	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 15:53:11	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 15:53:11	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:53:11	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 15:53:11	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 15:53:11	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 15:53:11	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 15:53:11	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 15:53:11	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 15:53:11	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 15:53:11	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 15:53:11	INFO	cli.py	Output directory set to output/debug/version_72
23 Jun 22 15:53:11	INFO	log.py	Logs saved to run.log
23 Jun 22 15:53:11	INFO	log.py	Core count             = 12
23 Jun 22 15:53:11	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 15:53:11	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 15:53:11	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 15:53:11	INFO	log.py	CUDA version           = 11.3
23 Jun 22 15:53:11	INFO	log.py	CUDA count             = 1
23 Jun 22 15:53:11	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 15:53:20	INFO	train_model.py	========== start training ==========
23 Jun 22 15:54:03	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 15:54:03	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | EfficientnetMaxPool | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork        | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | age_loss | MSELoss             | 0      | ?                   | ?               
3 | sex_loss | BCEWithLogitsLoss   | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 15:54:03	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetMaxPool     | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | age_loss                   | MSELoss                 | 0      | ?                   | ?                
24 | sex_loss                   | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 15:55:34	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 0.921
23 Jun 22 15:55:34	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached 0.92143 (best 0.92143), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_72/ckp/best_model.ckpt' as top 1
23 Jun 22 15:55:37	INFO	cli.py	===== Training finished ======
23 Jun 22 15:55:37	INFO	cli.py	Training time : 1.61min for 100 steps of training
23 Jun 22 15:55:37	INFO	cli.py	Training speed: 1.04 steps/second
23 Jun 22 15:55:37	INFO	train_model.py	========== Testing model ==========
23 Jun 22 15:55:37	INFO	cli.py	Using last obtained model
23 Jun 22 15:55:37	INFO	testing.py	====== Testing model =====
23 Jun 22 15:55:37	INFO	testing.py	Starting inference
23 Jun 22 15:55:37	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_72/ckp/last.ckpt
23 Jun 22 15:56:09	INFO	testing.py	normalizing images with: zscore
23 Jun 22 15:59:24	INFO	seed.py	Global seed set to 42
23 Jun 22 15:59:24	INFO	datasets.py	found 12610 train images
23 Jun 22 15:59:24	INFO	datasets.py	found 1425 val images
23 Jun 22 15:59:24	INFO	datasets.py	found 200 test images
23 Jun 22 15:59:24	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 15:59:24	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:59:26	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 15:59:27	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 15:59:27	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 15:59:27	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 15:59:27	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:59:28	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 15:59:28	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 15:59:28	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 15:59:28	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 15:59:28	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 15:59:28	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 15:59:28	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 15:59:28	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 15:59:28	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 15:59:28	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 15:59:28	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 15:59:28	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 15:59:28	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 15:59:28	INFO	cli.py	Output directory set to output/debug/version_73
23 Jun 22 15:59:28	INFO	log.py	Logs saved to run.log
23 Jun 22 15:59:28	INFO	log.py	Core count             = 12
23 Jun 22 15:59:28	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 15:59:28	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 15:59:28	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 15:59:28	INFO	log.py	CUDA version           = 11.3
23 Jun 22 15:59:28	INFO	log.py	CUDA count             = 1
23 Jun 22 15:59:28	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 15:59:39	INFO	train_model.py	========== start training ==========
23 Jun 22 15:59:41	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 15:59:41	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | EfficientnetMaxPool | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork        | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | age_loss | MSELoss             | 0      | ?                   | ?               
3 | sex_loss | BCEWithLogitsLoss   | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 15:59:41	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetMaxPool     | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | age_loss                   | MSELoss                 | 0      | ?                   | ?                
24 | sex_loss                   | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 16:01:13	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 0.934
23 Jun 22 16:01:13	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached 0.93436 (best 0.93436), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_73/ckp/best_model.ckpt' as top 1
23 Jun 22 16:01:16	INFO	cli.py	===== Training finished ======
23 Jun 22 16:01:16	INFO	cli.py	Training time : 1.62min for 100 steps of training
23 Jun 22 16:01:16	INFO	cli.py	Training speed: 1.03 steps/second
23 Jun 22 16:01:16	INFO	train_model.py	========== Testing model ==========
23 Jun 22 16:01:16	INFO	cli.py	Using last obtained model
23 Jun 22 16:01:16	INFO	testing.py	====== Testing model =====
23 Jun 22 16:01:16	INFO	testing.py	Starting inference
23 Jun 22 16:01:16	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_73/ckp/last.ckpt
23 Jun 22 16:01:16	INFO	testing.py	normalizing images with: zscore
23 Jun 22 16:01:16	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:01:18	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 16:01:20	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 16:01:20	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 16:03:06	INFO	seed.py	Global seed set to 42
23 Jun 22 16:03:06	INFO	datasets.py	found 12610 train images
23 Jun 22 16:03:06	INFO	datasets.py	found 1425 val images
23 Jun 22 16:03:06	INFO	datasets.py	found 200 test images
23 Jun 22 16:03:06	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 16:03:06	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:03:08	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 16:03:10	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 16:03:10	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 16:03:10	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 16:03:10	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:03:10	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:03:10	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:03:10	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:03:10	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 16:03:10	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:03:10	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:03:10	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:03:10	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:03:10	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 16:03:10	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 16:03:10	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 16:03:10	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 16:03:10	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 16:03:10	INFO	cli.py	Output directory set to output/debug/version_74
23 Jun 22 16:03:10	INFO	log.py	Logs saved to run.log
23 Jun 22 16:03:10	INFO	log.py	Core count             = 12
23 Jun 22 16:03:10	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 16:03:10	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 16:03:10	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 16:03:10	INFO	log.py	CUDA version           = 11.3
23 Jun 22 16:03:10	INFO	log.py	CUDA count             = 1
23 Jun 22 16:03:10	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 16:03:21	INFO	train_model.py	========== start training ==========
23 Jun 22 16:03:24	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 16:03:24	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | EfficientnetMaxPool | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork        | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | age_loss | MSELoss             | 0      | ?                   | ?               
3 | sex_loss | BCEWithLogitsLoss   | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 16:03:24	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetMaxPool     | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | age_loss                   | MSELoss                 | 0      | ?                   | ?                
24 | sex_loss                   | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 16:04:57	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 0.925
23 Jun 22 16:04:57	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached 0.92510 (best 0.92510), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_74/ckp/best_model.ckpt' as top 1
23 Jun 22 16:04:59	INFO	cli.py	===== Training finished ======
23 Jun 22 16:04:59	INFO	cli.py	Training time : 1.64min for 100 steps of training
23 Jun 22 16:04:59	INFO	cli.py	Training speed: 1.02 steps/second
23 Jun 22 16:04:59	INFO	train_model.py	========== Testing model ==========
23 Jun 22 16:04:59	INFO	cli.py	Using last obtained model
23 Jun 22 16:04:59	INFO	testing.py	====== Testing model =====
23 Jun 22 16:04:59	INFO	testing.py	Starting inference
23 Jun 22 16:05:00	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_74/ckp/last.ckpt
23 Jun 22 16:05:00	INFO	testing.py	normalizing images with: zscore
23 Jun 22 16:05:00	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:05:00	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:05:00	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:05:00	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:05:18	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:05:18	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:05:19	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:05:19	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:05:37	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:05:37	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:05:37	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:05:37	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:05:55	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:05:55	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:05:55	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:05:55	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:06:13	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:06:13	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:06:13	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:06:13	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:06:29	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:06:29	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:06:29	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:06:29	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:06:45	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:06:45	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:06:45	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:06:45	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:07:03	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:07:03	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:07:03	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:07:03	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:07:21	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:07:21	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:07:22	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:07:22	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:07:39	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:07:40	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:07:40	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:07:40	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:07:58	INFO	testing.py	normalizing images with: zscore
23 Jun 22 16:07:58	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:07:58	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:07:58	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:07:58	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:08:04	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:08:04	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:08:04	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:08:04	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:08:08	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:08:08	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:08:08	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:08:08	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:08:14	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:08:14	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:08:14	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:08:14	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:08:19	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:08:19	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:08:19	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:08:19	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:08:23	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:08:23	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:08:23	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:08:23	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:08:27	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:08:27	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:08:28	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:08:28	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:08:32	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:08:32	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:08:32	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:08:32	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:08:37	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:08:37	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:08:37	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:08:37	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:08:42	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:08:42	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:08:42	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:08:42	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:08:47	INFO	testing.py	normalizing images with: zscore
23 Jun 22 16:08:47	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:08:48	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 16:08:50	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 16:08:50	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 16:10:44	INFO	testing.py	train mad (without TTA and regression): 127.32240859703387
23 Jun 22 16:10:44	INFO	testing.py	validation mad (without TTA and regression): 127.08757905832748
23 Jun 22 16:10:44	INFO	testing.py	test mad (without TTA and regression): 132.0925
23 Jun 22 16:10:44	INFO	testing.py	===== regress correct on raw images =====
23 Jun 22 16:10:44	INFO	testing.py	Linear bias prediction:	slope: -8299.7041	intercept: -101.7471	r = -0.2110	p-value = 7.5E-127	std error = 3.4E+02
23 Jun 22 16:10:44	INFO	testing.py	train mad (after regression): 32.28058579189468
23 Jun 22 16:10:44	INFO	testing.py	validation mad (after regression): 32.701955595572734
23 Jun 22 16:10:44	INFO	testing.py	test mad (after regression): 34.8270166015625
23 Jun 22 16:10:44	INFO	testing.py	===== regress correct on raw images and TTA =====
23 Jun 22 16:10:44	INFO	testing.py	Linear bias prediction:	slope: -8299.7048	intercept: -101.7471	r = -0.2110	p-value = 7.5E-127	std error = 3.4E+02
23 Jun 22 16:10:44	INFO	testing.py	train mad (after regression and TTA): 32.280588622017206
23 Jun 22 16:10:44	INFO	testing.py	validation mad (after regression and TTA): 32.70195705462629
23 Jun 22 16:10:44	INFO	testing.py	test mad (after regression and TTA): 34.827020847148425
23 Jun 22 16:10:44	INFO	testing.py	saving outputs to output/debug/version_74/predictions
23 Jun 22 16:10:46	INFO	train_model.py	======= END =========
23 Jun 22 16:27:56	INFO	seed.py	Global seed set to 42
23 Jun 22 16:27:56	INFO	datasets.py	found 12610 train images
23 Jun 22 16:27:56	INFO	datasets.py	found 1425 val images
23 Jun 22 16:27:56	INFO	datasets.py	found 200 test images
23 Jun 22 16:27:56	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 16:27:56	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:27:57	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 16:27:59	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 16:27:59	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 16:27:59	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 16:27:59	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:27:59	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:27:59	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:27:59	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:27:59	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 16:27:59	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:27:59	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:28:00	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:28:00	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:28:16	INFO	seed.py	Global seed set to 42
23 Jun 22 16:28:16	INFO	datasets.py	found 12610 train images
23 Jun 22 16:28:16	INFO	datasets.py	found 1425 val images
23 Jun 22 16:28:16	INFO	datasets.py	found 200 test images
23 Jun 22 16:28:16	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 16:28:16	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:28:17	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 16:28:19	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 16:28:19	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 16:28:19	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 16:28:19	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:28:19	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:28:19	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:28:19	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:28:19	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 16:28:19	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:28:19	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:28:19	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:28:19	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:30:11	INFO	seed.py	Global seed set to 42
23 Jun 22 16:30:11	INFO	datasets.py	found 12610 train images
23 Jun 22 16:30:11	INFO	datasets.py	found 1425 val images
23 Jun 22 16:30:11	INFO	datasets.py	found 200 test images
23 Jun 22 16:30:11	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 16:30:11	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:30:13	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 16:30:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 16:30:15	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 16:30:15	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 16:30:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:30:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:30:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:30:15	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:30:15	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 16:30:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:30:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:30:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:30:15	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:30:16	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 16:30:16	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 16:30:16	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 16:30:16	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 16:30:16	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 16:30:16	INFO	cli.py	Output directory set to output/debug/version_75
23 Jun 22 16:30:16	INFO	log.py	Logs saved to run.log
23 Jun 22 16:30:16	INFO	log.py	Core count             = 12
23 Jun 22 16:30:16	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 16:30:16	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 16:30:16	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 16:30:16	INFO	log.py	CUDA version           = 11.3
23 Jun 22 16:30:16	INFO	log.py	CUDA count             = 1
23 Jun 22 16:30:16	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 16:30:26	INFO	train_model.py	========== start training ==========
23 Jun 22 16:30:28	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 16:30:28	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | Inceptionv3Backbone | 21.8 M | ?                   | ?               
1 | dense    | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]
2 | age_loss | MSELoss             | 0      | ?                   | ?               
3 | sex_loss | BCEWithLogitsLoss   | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 16:30:28	INFO	model_summary.py	
   | Name                 | Type                | Params | In sizes            | Out sizes         
---------------------------------------------------------------------------------------------------------
0  | backbone             | Inceptionv3Backbone | 21.8 M | ?                   | ?                 
1  | backbone.features    | Sequential          | 21.8 M | [4, 1, 512, 512]    | [4, 2048, 1, 1]   
2  | backbone.features.0  | Conv2d              | 320    | [4, 1, 512, 512]    | [4, 32, 255, 255] 
3  | backbone.features.1  | BatchNorm2d         | 64     | [4, 32, 255, 255]   | [4, 32, 255, 255] 
4  | backbone.features.2  | BasicConv2d         | 9.3 K  | [4, 32, 255, 255]   | [4, 32, 253, 253] 
5  | backbone.features.3  | BasicConv2d         | 18.6 K | [4, 32, 253, 253]   | [4, 64, 253, 253] 
6  | backbone.features.4  | MaxPool2d           | 0      | [4, 64, 253, 253]   | [4, 64, 126, 126] 
7  | backbone.features.5  | BasicConv2d         | 5.3 K  | [4, 64, 126, 126]   | [4, 80, 126, 126] 
8  | backbone.features.6  | BasicConv2d         | 138 K  | [4, 80, 126, 126]   | [4, 192, 124, 124]
9  | backbone.features.7  | MaxPool2d           | 0      | [4, 192, 124, 124]  | [4, 192, 61, 61]  
10 | backbone.features.8  | InceptionA          | 255 K  | [4, 192, 61, 61]    | [4, 256, 61, 61]  
11 | backbone.features.9  | InceptionA          | 277 K  | [4, 256, 61, 61]    | [4, 288, 61, 61]  
12 | backbone.features.10 | InceptionA          | 285 K  | [4, 288, 61, 61]    | [4, 288, 61, 61]  
13 | backbone.features.11 | InceptionB          | 1.2 M  | [4, 288, 61, 61]    | [4, 768, 30, 30]  
14 | backbone.features.12 | InceptionC          | 1.3 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
15 | backbone.features.13 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
16 | backbone.features.14 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
17 | backbone.features.15 | InceptionC          | 2.1 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
18 | backbone.features.16 | InceptionD          | 1.7 M  | [4, 768, 30, 30]    | [4, 1280, 14, 14] 
19 | backbone.features.17 | InceptionE          | 5.0 M  | [4, 1280, 14, 14]   | [4, 2048, 14, 14] 
20 | backbone.features.18 | InceptionE          | 6.1 M  | [4, 2048, 14, 14]   | [4, 2048, 14, 14] 
21 | backbone.features.19 | AdaptiveAvgPool2d   | 0      | [4, 2048, 14, 14]   | [4, 2048, 1, 1]   
22 | dense                | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]  
23 | dense.dropout        | Dropout             | 0      | [4, 1024]           | [4, 1024]         
24 | dense.fc_gender_in   | Linear              | 64     | [4, 1]              | [4, 32]           
25 | dense.act            | ReLU                | 0      | [4, 32]             | [4, 32]           
26 | dense.dense_blocks   | ModuleList          | 4.0 M  | ?                   | ?                 
27 | dense.dense_blocks.0 | Linear              | 2.1 M  | [4, 2080]           | [4, 1024]         
28 | dense.dense_blocks.1 | Linear              | 1.0 M  | [4, 1024]           | [4, 1024]         
29 | dense.dense_blocks.2 | Linear              | 524 K  | [4, 1024]           | [4, 512]          
30 | dense.dense_blocks.3 | Linear              | 262 K  | [4, 512]            | [4, 512]          
31 | dense.fc_boneage     | Linear              | 513    | [4, 512]            | [4, 1]            
32 | dense.fc_sex         | Linear              | 513    | [4, 512]            | [4, 1]            
33 | age_loss             | MSELoss             | 0      | ?                   | ?                 
34 | sex_loss             | BCEWithLogitsLoss   | 0      | ?                   | ?                 
---------------------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 16:31:43	INFO	early_stopping.py	Monitored metric Step-wise/val_mad = nan is not finite. Previous best value was inf. Signaling Trainer to stop.
23 Jun 22 16:31:43	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached inf (best inf), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_75/ckp/best_model.ckpt' as top 1
23 Jun 22 16:31:46	INFO	cli.py	===== Training finished ======
23 Jun 22 16:31:46	INFO	cli.py	Training time : 1.34min for 100 steps of training
23 Jun 22 16:31:46	INFO	cli.py	Training speed: 1.25 steps/second
23 Jun 22 16:31:46	INFO	train_model.py	========== Testing model ==========
23 Jun 22 16:31:46	INFO	cli.py	Using last obtained model
23 Jun 22 16:31:46	INFO	testing.py	====== Testing model =====
23 Jun 22 16:31:46	INFO	testing.py	Starting inference
23 Jun 22 16:31:47	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_75/ckp/last.ckpt
23 Jun 22 16:31:47	INFO	testing.py	normalizing images with: zscore
23 Jun 22 16:31:47	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:31:47	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:31:47	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:31:47	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:32:05	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:32:05	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:32:06	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:32:06	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:32:23	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:32:23	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:32:24	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:32:24	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:32:41	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:32:41	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:32:42	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:32:42	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:32:59	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:33:00	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:33:00	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:33:00	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:33:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:33:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:33:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:33:15	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:33:31	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:33:31	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:33:31	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:33:31	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:33:49	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:33:49	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:33:49	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:33:49	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:34:07	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:34:07	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:34:07	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:34:07	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:34:25	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:34:25	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:34:25	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:34:25	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:34:43	INFO	testing.py	normalizing images with: zscore
23 Jun 22 16:34:44	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:34:44	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:34:44	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:34:44	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:34:48	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:34:48	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:34:48	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:34:48	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:34:53	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:34:53	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:34:53	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:34:53	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:34:57	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:34:57	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:34:57	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:34:57	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:35:02	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:35:02	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:35:02	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:35:02	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:35:06	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:35:06	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:35:06	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:35:06	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:35:10	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:35:10	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:35:10	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:35:10	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:35:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:35:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:35:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:35:15	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:35:19	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:35:19	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:35:19	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:35:19	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:35:24	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:35:24	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:35:24	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:35:24	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:35:28	INFO	testing.py	normalizing images with: zscore
23 Jun 22 16:35:28	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:35:30	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 16:35:31	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 16:35:31	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 16:37:19	INFO	testing.py	train mad (without TTA and regression): nan
23 Jun 22 16:37:19	INFO	testing.py	validation mad (without TTA and regression): nan
23 Jun 22 16:37:19	INFO	testing.py	test mad (without TTA and regression): nan
23 Jun 22 16:37:19	INFO	testing.py	===== regress correct on raw images =====
23 Jun 22 16:37:19	INFO	testing.py	Linear bias prediction:	slope: nan	intercept: nan	r = nan	p-value = NAN	std error = NAN
23 Jun 22 16:37:19	INFO	testing.py	train mad (after regression): nan
23 Jun 22 16:37:19	INFO	testing.py	validation mad (after regression): nan
23 Jun 22 16:37:19	INFO	testing.py	test mad (after regression): nan
23 Jun 22 16:37:19	INFO	testing.py	===== regress correct on raw images and TTA =====
23 Jun 22 16:37:19	INFO	testing.py	Linear bias prediction:	slope: nan	intercept: nan	r = nan	p-value = NAN	std error = NAN
23 Jun 22 16:37:19	INFO	testing.py	train mad (after regression and TTA): nan
23 Jun 22 16:37:19	INFO	testing.py	validation mad (after regression and TTA): nan
23 Jun 22 16:37:19	INFO	testing.py	test mad (after regression and TTA): nan
23 Jun 22 16:37:19	INFO	testing.py	saving outputs to output/debug/version_75/predictions
23 Jun 22 16:37:21	INFO	train_model.py	======= END =========
23 Jun 22 16:54:11	INFO	seed.py	Global seed set to 42
23 Jun 22 16:54:11	INFO	datasets.py	found 12610 train images
23 Jun 22 16:54:11	INFO	datasets.py	found 1425 val images
23 Jun 22 16:54:11	INFO	datasets.py	found 200 test images
23 Jun 22 16:54:11	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 16:54:11	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:54:13	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 16:54:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 16:54:15	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 16:54:15	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 16:54:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:54:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 16:54:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 16:54:15	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 16:54:15	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 16:54:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 16:54:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 16:54:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 16:54:15	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 16:54:15	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 16:54:15	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 16:54:15	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 16:54:15	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 16:54:15	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 16:54:15	INFO	cli.py	Output directory set to output/debug/version_76
23 Jun 22 16:54:15	INFO	log.py	Logs saved to run.log
23 Jun 22 16:54:15	INFO	log.py	Core count             = 12
23 Jun 22 16:54:15	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 16:54:15	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 16:54:15	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 16:54:15	INFO	log.py	CUDA version           = 11.3
23 Jun 22 16:54:15	INFO	log.py	CUDA count             = 1
23 Jun 22 16:54:15	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 16:54:24	INFO	train_model.py	========== start training ==========
23 Jun 22 16:54:28	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 16:54:28	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | age_loss | MSELoss              | 0      | ?                   | ?               
3 | sex_loss | BCEWithLogitsLoss    | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 16:54:28	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | age_loss                   | MSELoss                 | 0      | ?                   | ?                
24 | sex_loss                   | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 17:24:00	INFO	cli.py	===== Training finished ======
23 Jun 22 17:24:00	INFO	cli.py	Training time : 29.57min for 34 steps of training
23 Jun 22 17:24:00	INFO	cli.py	Training speed: 0.02 steps/second
23 Jun 22 17:24:00	INFO	train_model.py	========== Testing model ==========
23 Jun 22 17:24:00	INFO	cli.py	Using last obtained model
23 Jun 22 17:24:00	INFO	testing.py	====== Testing model =====
23 Jun 22 17:24:00	INFO	testing.py	Starting inference
23 Jun 22 17:24:05	INFO	seed.py	Global seed set to 42
23 Jun 22 17:24:05	INFO	datasets.py	found 12610 train images
23 Jun 22 17:24:05	INFO	datasets.py	found 1425 val images
23 Jun 22 17:24:05	INFO	datasets.py	found 200 test images
23 Jun 22 17:24:05	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 17:24:05	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:24:07	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 17:24:09	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 17:24:09	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 17:24:09	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 17:24:09	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:24:09	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 17:24:09	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 17:24:09	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 17:24:09	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 17:24:09	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:24:09	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 17:24:09	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 17:24:09	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 17:24:51	INFO	seed.py	Global seed set to 42
23 Jun 22 17:24:51	INFO	datasets.py	found 12610 train images
23 Jun 22 17:24:51	INFO	datasets.py	found 1425 val images
23 Jun 22 17:24:51	INFO	datasets.py	found 200 test images
23 Jun 22 17:24:51	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 17:24:51	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:24:52	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 17:24:54	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 17:24:54	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 17:24:54	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 17:24:54	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:24:54	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 17:24:54	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 17:24:54	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 17:24:54	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 17:24:54	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:24:54	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 17:24:54	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 17:24:54	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 17:25:51	INFO	seed.py	Global seed set to 42
23 Jun 22 17:25:51	INFO	datasets.py	found 12610 train images
23 Jun 22 17:25:51	INFO	datasets.py	found 1425 val images
23 Jun 22 17:25:51	INFO	datasets.py	found 200 test images
23 Jun 22 17:25:51	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 17:25:51	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:25:53	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 17:25:55	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 17:25:55	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 17:25:55	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 17:25:55	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:25:55	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 17:25:55	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 17:25:55	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 17:25:55	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 17:25:55	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:25:55	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 17:25:55	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 17:25:55	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 17:26:32	INFO	seed.py	Global seed set to 42
23 Jun 22 17:26:32	INFO	datasets.py	found 12610 train images
23 Jun 22 17:26:32	INFO	datasets.py	found 1425 val images
23 Jun 22 17:26:32	INFO	datasets.py	found 200 test images
23 Jun 22 17:26:32	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 17:26:32	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:26:34	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 17:26:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 17:26:35	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 17:26:35	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 17:26:35	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:26:36	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 17:26:36	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 17:26:36	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 17:26:36	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 17:26:36	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:26:36	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 17:26:36	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 17:26:36	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 17:26:36	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 17:26:36	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 17:26:36	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 17:26:36	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 17:26:36	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 17:26:36	INFO	cli.py	Output directory set to output/debug/version_77
23 Jun 22 17:26:36	INFO	log.py	Logs saved to run.log
23 Jun 22 17:26:36	INFO	log.py	Core count             = 12
23 Jun 22 17:26:36	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 17:26:36	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 17:26:36	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 17:26:36	INFO	log.py	CUDA version           = 11.3
23 Jun 22 17:26:36	INFO	log.py	CUDA count             = 1
23 Jun 22 17:26:36	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 17:26:47	INFO	train_model.py	========== start training ==========
23 Jun 22 17:26:49	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 17:27:55	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 17:27:57	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 0      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 17:28:59	INFO	seed.py	Global seed set to 42
23 Jun 22 17:28:59	INFO	datasets.py	found 12610 train images
23 Jun 22 17:28:59	INFO	datasets.py	found 1425 val images
23 Jun 22 17:28:59	INFO	datasets.py	found 200 test images
23 Jun 22 17:28:59	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 17:28:59	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:29:00	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 17:29:02	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 17:29:02	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 17:29:02	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 17:29:02	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:29:02	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 17:29:03	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 17:29:03	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 17:29:03	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 17:29:03	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:29:03	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 17:29:03	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 17:29:03	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 17:29:03	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 17:29:03	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 17:29:03	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 17:29:03	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 17:29:03	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 17:29:03	INFO	cli.py	Output directory set to output/debug/version_78
23 Jun 22 17:29:03	INFO	log.py	Logs saved to run.log
23 Jun 22 17:29:03	INFO	log.py	Core count             = 12
23 Jun 22 17:29:03	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 17:29:03	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 17:29:03	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 17:29:03	INFO	log.py	CUDA version           = 11.3
23 Jun 22 17:29:03	INFO	log.py	CUDA count             = 1
23 Jun 22 17:29:03	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 17:29:11	INFO	train_model.py	========== start training ==========
23 Jun 22 17:29:52	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 17:29:52	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 17:29:52	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 0      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 17:30:07	INFO	seed.py	Global seed set to 42
23 Jun 22 17:30:07	INFO	datasets.py	found 12610 train images
23 Jun 22 17:30:07	INFO	datasets.py	found 1425 val images
23 Jun 22 17:30:07	INFO	datasets.py	found 200 test images
23 Jun 22 17:30:07	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 17:30:07	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:30:08	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 17:30:10	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 17:30:10	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 17:30:10	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 17:30:10	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:30:10	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 17:30:10	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 17:30:10	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 17:30:10	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 17:30:10	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:30:10	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 17:30:10	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 17:30:10	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 17:30:11	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 17:30:11	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 17:30:11	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 17:30:11	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 17:30:11	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 17:30:11	INFO	cli.py	Output directory set to output/debug/version_79
23 Jun 22 17:30:11	INFO	log.py	Logs saved to run.log
23 Jun 22 17:30:11	INFO	log.py	Core count             = 12
23 Jun 22 17:30:11	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 17:30:11	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 17:30:11	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 17:30:11	INFO	log.py	CUDA version           = 11.3
23 Jun 22 17:30:11	INFO	log.py	CUDA count             = 1
23 Jun 22 17:30:11	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 17:30:21	INFO	train_model.py	========== start training ==========
23 Jun 22 17:30:24	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 17:30:24	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 17:30:24	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 0      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 17:49:04	INFO	seed.py	Global seed set to 42
23 Jun 22 17:49:04	INFO	datasets.py	found 12610 train images
23 Jun 22 17:49:04	INFO	datasets.py	found 1425 val images
23 Jun 22 17:49:04	INFO	datasets.py	found 200 test images
23 Jun 22 17:49:04	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 17:49:04	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:49:05	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 17:49:07	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 17:49:07	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 17:49:07	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 17:49:07	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:49:07	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 17:49:08	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 17:49:08	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 17:49:08	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 17:49:08	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:49:08	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 17:49:08	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 17:49:08	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 17:49:08	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 17:49:08	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 17:49:08	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 17:49:08	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 17:49:08	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 17:49:08	INFO	cli.py	Output directory set to output/debug/version_80
23 Jun 22 17:49:08	INFO	log.py	Logs saved to run.log
23 Jun 22 17:49:08	INFO	log.py	Core count             = 12
23 Jun 22 17:49:08	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 17:49:08	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 17:49:08	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 17:49:08	INFO	log.py	CUDA version           = 11.3
23 Jun 22 17:49:08	INFO	log.py	CUDA count             = 1
23 Jun 22 17:49:08	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 17:49:15	INFO	train_model.py	========== start training ==========
23 Jun 22 17:49:59	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 17:49:59	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 17:49:59	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 0      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 17:52:30	INFO	cli.py	===== Training finished ======
23 Jun 22 17:52:30	INFO	cli.py	Training time : 2.57min for 0 steps of training
23 Jun 22 17:52:30	INFO	cli.py	Training speed: 0.00 steps/second
23 Jun 22 17:52:30	INFO	train_model.py	========== Testing model ==========
23 Jun 22 17:52:30	INFO	cli.py	Using last obtained model
23 Jun 22 17:52:30	INFO	testing.py	====== Testing model =====
23 Jun 22 17:52:30	INFO	testing.py	Starting inference
23 Jun 22 17:52:36	INFO	seed.py	Global seed set to 42
23 Jun 22 17:52:54	INFO	datasets.py	found 12610 train images
23 Jun 22 17:52:54	INFO	datasets.py	found 1425 val images
23 Jun 22 17:52:54	INFO	datasets.py	found 200 test images
23 Jun 22 17:55:23	INFO	seed.py	Global seed set to 42
23 Jun 22 17:55:29	INFO	datasets.py	found 12610 train images
23 Jun 22 17:55:29	INFO	datasets.py	found 1425 val images
23 Jun 22 17:55:29	INFO	datasets.py	found 200 test images
23 Jun 22 17:55:32	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 17:55:32	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:55:34	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 17:55:36	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 17:55:36	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 17:55:36	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 17:55:36	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:55:36	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 17:55:36	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 17:55:36	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 17:55:36	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 17:55:36	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 17:55:36	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 17:55:36	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 17:55:36	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 17:55:36	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 17:55:36	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 17:55:36	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 17:55:36	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 17:55:36	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 17:55:36	INFO	cli.py	Output directory set to output/debug/version_81
23 Jun 22 17:55:36	INFO	log.py	Logs saved to run.log
23 Jun 22 17:55:36	INFO	log.py	Core count             = 12
23 Jun 22 17:55:36	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 17:55:36	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 17:55:36	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 17:55:36	INFO	log.py	CUDA version           = 11.3
23 Jun 22 17:55:36	INFO	log.py	CUDA count             = 1
23 Jun 22 17:55:36	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 17:55:51	INFO	train_model.py	========== start training ==========
23 Jun 22 17:55:54	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 17:55:54	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 17:55:54	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 0      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 18:11:49	INFO	seed.py	Global seed set to 42
23 Jun 22 18:11:49	INFO	datasets.py	found 12610 train images
23 Jun 22 18:11:49	INFO	datasets.py	found 1425 val images
23 Jun 22 18:11:49	INFO	datasets.py	found 200 test images
23 Jun 22 18:11:49	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 18:11:49	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:11:50	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 18:11:52	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 18:11:52	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 18:11:52	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 18:11:52	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:11:52	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:11:52	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:11:52	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:11:52	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 18:11:52	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:11:52	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 18:11:52	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 18:11:52	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 18:11:53	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 18:11:53	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 18:11:53	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 18:11:53	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 18:11:53	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 18:11:53	INFO	cli.py	Output directory set to output/debug/version_82
23 Jun 22 18:11:53	INFO	log.py	Logs saved to run.log
23 Jun 22 18:11:53	INFO	log.py	Core count             = 12
23 Jun 22 18:11:53	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 18:11:53	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 18:11:53	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 18:11:53	INFO	log.py	CUDA version           = 11.3
23 Jun 22 18:11:53	INFO	log.py	CUDA count             = 1
23 Jun 22 18:11:53	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 18:12:03	INFO	train_model.py	========== start training ==========
23 Jun 22 18:12:06	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 18:12:06	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 18:12:06	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 0      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 18:13:37	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 101.307
23 Jun 22 18:13:37	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached 101.30680 (best 101.30680), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_82/ckp/best_model.ckpt' as top 1
23 Jun 22 18:13:40	INFO	cli.py	===== Training finished ======
23 Jun 22 18:13:40	INFO	cli.py	Training time : 1.61min for 100 steps of training
23 Jun 22 18:13:40	INFO	cli.py	Training speed: 1.04 steps/second
23 Jun 22 18:13:40	INFO	train_model.py	========== Testing model ==========
23 Jun 22 18:13:40	INFO	cli.py	Using last obtained model
23 Jun 22 18:13:40	INFO	testing.py	====== Testing model =====
23 Jun 22 18:13:40	INFO	testing.py	Starting inference
23 Jun 22 18:13:40	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_82/ckp/last.ckpt
23 Jun 22 18:13:40	INFO	testing.py	normalizing images with: zscore
23 Jun 22 18:13:40	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:13:41	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:13:41	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:13:41	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:13:59	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:13:59	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:13:59	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:13:59	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:14:17	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:14:17	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:14:17	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:14:17	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:14:35	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:14:35	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:14:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:14:35	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:15:11	INFO	seed.py	Global seed set to 42
23 Jun 22 18:15:11	INFO	datasets.py	found 12610 train images
23 Jun 22 18:15:11	INFO	datasets.py	found 1425 val images
23 Jun 22 18:15:11	INFO	datasets.py	found 200 test images
23 Jun 22 18:15:11	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 18:15:11	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:15:13	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 18:15:14	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 18:15:14	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 18:15:14	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 18:15:14	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:15:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:15:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:15:15	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:15:15	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 18:15:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:15:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 18:15:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 18:15:15	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 18:15:16	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 18:15:16	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 18:15:16	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 18:15:16	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 18:15:16	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 18:15:16	INFO	cli.py	Output directory set to output/debug/version_83
23 Jun 22 18:15:16	INFO	log.py	Logs saved to run.log
23 Jun 22 18:15:16	INFO	log.py	Core count             = 12
23 Jun 22 18:15:16	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 18:15:16	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 18:15:16	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 18:15:16	INFO	log.py	CUDA version           = 11.3
23 Jun 22 18:15:16	INFO	log.py	CUDA count             = 1
23 Jun 22 18:15:16	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 18:15:26	INFO	train_model.py	========== start training ==========
23 Jun 22 18:15:28	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 18:15:28	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | Inceptionv3Backbone | 21.8 M | ?                   | ?               
1 | dense    | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss       | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:15:28	INFO	model_summary.py	
   | Name                 | Type                | Params | In sizes            | Out sizes         
---------------------------------------------------------------------------------------------------------
0  | backbone             | Inceptionv3Backbone | 21.8 M | ?                   | ?                 
1  | backbone.features    | Sequential          | 21.8 M | [4, 1, 512, 512]    | [4, 2048, 1, 1]   
2  | backbone.features.0  | Conv2d              | 320    | [4, 1, 512, 512]    | [4, 32, 255, 255] 
3  | backbone.features.1  | BatchNorm2d         | 64     | [4, 32, 255, 255]   | [4, 32, 255, 255] 
4  | backbone.features.2  | BasicConv2d         | 9.3 K  | [4, 32, 255, 255]   | [4, 32, 253, 253] 
5  | backbone.features.3  | BasicConv2d         | 18.6 K | [4, 32, 253, 253]   | [4, 64, 253, 253] 
6  | backbone.features.4  | MaxPool2d           | 0      | [4, 64, 253, 253]   | [4, 64, 126, 126] 
7  | backbone.features.5  | BasicConv2d         | 5.3 K  | [4, 64, 126, 126]   | [4, 80, 126, 126] 
8  | backbone.features.6  | BasicConv2d         | 138 K  | [4, 80, 126, 126]   | [4, 192, 124, 124]
9  | backbone.features.7  | MaxPool2d           | 0      | [4, 192, 124, 124]  | [4, 192, 61, 61]  
10 | backbone.features.8  | InceptionA          | 255 K  | [4, 192, 61, 61]    | [4, 256, 61, 61]  
11 | backbone.features.9  | InceptionA          | 277 K  | [4, 256, 61, 61]    | [4, 288, 61, 61]  
12 | backbone.features.10 | InceptionA          | 285 K  | [4, 288, 61, 61]    | [4, 288, 61, 61]  
13 | backbone.features.11 | InceptionB          | 1.2 M  | [4, 288, 61, 61]    | [4, 768, 30, 30]  
14 | backbone.features.12 | InceptionC          | 1.3 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
15 | backbone.features.13 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
16 | backbone.features.14 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
17 | backbone.features.15 | InceptionC          | 2.1 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
18 | backbone.features.16 | InceptionD          | 1.7 M  | [4, 768, 30, 30]    | [4, 1280, 14, 14] 
19 | backbone.features.17 | InceptionE          | 5.0 M  | [4, 1280, 14, 14]   | [4, 2048, 14, 14] 
20 | backbone.features.18 | InceptionE          | 6.1 M  | [4, 2048, 14, 14]   | [4, 2048, 14, 14] 
21 | backbone.features.19 | AdaptiveAvgPool2d   | 0      | [4, 2048, 14, 14]   | [4, 2048, 1, 1]   
22 | dense                | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]  
23 | dense.dropout        | Dropout             | 0      | [4, 1024]           | [4, 1024]         
24 | dense.fc_gender_in   | Linear              | 64     | [4, 1]              | [4, 32]           
25 | dense.act            | ReLU                | 0      | [4, 32]             | [4, 32]           
26 | dense.dense_blocks   | ModuleList          | 4.0 M  | ?                   | ?                 
27 | dense.dense_blocks.0 | Linear              | 2.1 M  | [4, 2080]           | [4, 1024]         
28 | dense.dense_blocks.1 | Linear              | 1.0 M  | [4, 1024]           | [4, 1024]         
29 | dense.dense_blocks.2 | Linear              | 524 K  | [4, 1024]           | [4, 512]          
30 | dense.dense_blocks.3 | Linear              | 262 K  | [4, 512]            | [4, 512]          
31 | dense.fc_boneage     | Linear              | 513    | [4, 512]            | [4, 1]            
32 | dense.fc_sex         | Linear              | 513    | [4, 512]            | [4, 1]            
33 | loss                 | MultiTaskLoss       | 0      | ?                   | ?                 
34 | loss.age_loss        | MSELoss             | 0      | ?                   | ?                 
35 | loss.sex_loss        | BCEWithLogitsLoss   | 0      | ?                   | ?                 
---------------------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:16:47	INFO	early_stopping.py	Monitored metric Step-wise/val_mad = nan is not finite. Previous best value was inf. Signaling Trainer to stop.
23 Jun 22 18:16:47	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached inf (best inf), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_83/ckp/best_model.ckpt' as top 1
23 Jun 22 18:16:51	INFO	cli.py	===== Training finished ======
23 Jun 22 18:16:51	INFO	cli.py	Training time : 1.41min for 100 steps of training
23 Jun 22 18:16:51	INFO	cli.py	Training speed: 1.18 steps/second
23 Jun 22 18:16:51	INFO	train_model.py	========== Testing model ==========
23 Jun 22 18:16:51	INFO	cli.py	Using last obtained model
23 Jun 22 18:16:51	INFO	testing.py	====== Testing model =====
23 Jun 22 18:16:51	INFO	testing.py	Starting inference
23 Jun 22 18:16:52	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_83/ckp/last.ckpt
23 Jun 22 18:16:52	INFO	testing.py	normalizing images with: zscore
23 Jun 22 18:16:52	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:16:52	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:16:52	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:16:52	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:17:10	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:17:11	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:17:11	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:17:11	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:17:30	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:17:30	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:17:30	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:17:30	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:17:49	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:17:49	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:17:49	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:17:49	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:18:07	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:18:08	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:18:08	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:18:08	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:18:23	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:18:23	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:18:24	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:18:24	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:18:39	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:18:39	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:18:40	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:18:40	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:18:58	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:18:58	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:18:58	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:18:58	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:19:17	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:19:17	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:19:17	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:19:17	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:19:38	INFO	seed.py	Global seed set to 42
23 Jun 22 18:19:38	INFO	datasets.py	found 12610 train images
23 Jun 22 18:19:38	INFO	datasets.py	found 1425 val images
23 Jun 22 18:19:38	INFO	datasets.py	found 200 test images
23 Jun 22 18:19:38	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 18:19:38	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:19:40	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 18:19:41	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 18:19:41	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 18:19:41	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 18:19:41	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:19:41	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:19:42	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:19:42	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:19:42	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 18:19:42	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:19:42	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 18:19:42	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 18:19:42	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 18:19:42	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 18:19:42	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 18:19:42	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 18:19:42	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 18:19:42	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 18:19:42	INFO	cli.py	Output directory set to output/debug/version_0
23 Jun 22 18:19:42	INFO	log.py	Logs saved to run.log
23 Jun 22 18:19:42	INFO	log.py	Core count             = 12
23 Jun 22 18:19:42	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 18:19:42	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 18:19:42	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 18:19:42	INFO	log.py	CUDA version           = 11.3
23 Jun 22 18:19:42	INFO	log.py	CUDA count             = 1
23 Jun 22 18:19:42	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 18:19:53	INFO	train_model.py	========== start training ==========
23 Jun 22 18:19:55	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 18:19:55	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | Inceptionv3Backbone | 21.8 M | ?                   | ?               
1 | dense    | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss       | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:19:55	INFO	model_summary.py	
   | Name                 | Type                | Params | In sizes            | Out sizes         
---------------------------------------------------------------------------------------------------------
0  | backbone             | Inceptionv3Backbone | 21.8 M | ?                   | ?                 
1  | backbone.features    | Sequential          | 21.8 M | [4, 1, 512, 512]    | [4, 2048, 1, 1]   
2  | backbone.features.0  | Conv2d              | 320    | [4, 1, 512, 512]    | [4, 32, 255, 255] 
3  | backbone.features.1  | BatchNorm2d         | 64     | [4, 32, 255, 255]   | [4, 32, 255, 255] 
4  | backbone.features.2  | BasicConv2d         | 9.3 K  | [4, 32, 255, 255]   | [4, 32, 253, 253] 
5  | backbone.features.3  | BasicConv2d         | 18.6 K | [4, 32, 253, 253]   | [4, 64, 253, 253] 
6  | backbone.features.4  | MaxPool2d           | 0      | [4, 64, 253, 253]   | [4, 64, 126, 126] 
7  | backbone.features.5  | BasicConv2d         | 5.3 K  | [4, 64, 126, 126]   | [4, 80, 126, 126] 
8  | backbone.features.6  | BasicConv2d         | 138 K  | [4, 80, 126, 126]   | [4, 192, 124, 124]
9  | backbone.features.7  | MaxPool2d           | 0      | [4, 192, 124, 124]  | [4, 192, 61, 61]  
10 | backbone.features.8  | InceptionA          | 255 K  | [4, 192, 61, 61]    | [4, 256, 61, 61]  
11 | backbone.features.9  | InceptionA          | 277 K  | [4, 256, 61, 61]    | [4, 288, 61, 61]  
12 | backbone.features.10 | InceptionA          | 285 K  | [4, 288, 61, 61]    | [4, 288, 61, 61]  
13 | backbone.features.11 | InceptionB          | 1.2 M  | [4, 288, 61, 61]    | [4, 768, 30, 30]  
14 | backbone.features.12 | InceptionC          | 1.3 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
15 | backbone.features.13 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
16 | backbone.features.14 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
17 | backbone.features.15 | InceptionC          | 2.1 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
18 | backbone.features.16 | InceptionD          | 1.7 M  | [4, 768, 30, 30]    | [4, 1280, 14, 14] 
19 | backbone.features.17 | InceptionE          | 5.0 M  | [4, 1280, 14, 14]   | [4, 2048, 14, 14] 
20 | backbone.features.18 | InceptionE          | 6.1 M  | [4, 2048, 14, 14]   | [4, 2048, 14, 14] 
21 | backbone.features.19 | AdaptiveAvgPool2d   | 0      | [4, 2048, 14, 14]   | [4, 2048, 1, 1]   
22 | dense                | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]  
23 | dense.dropout        | Dropout             | 0      | [4, 1024]           | [4, 1024]         
24 | dense.fc_gender_in   | Linear              | 64     | [4, 1]              | [4, 32]           
25 | dense.act            | ReLU                | 0      | [4, 32]             | [4, 32]           
26 | dense.dense_blocks   | ModuleList          | 4.0 M  | ?                   | ?                 
27 | dense.dense_blocks.0 | Linear              | 2.1 M  | [4, 2080]           | [4, 1024]         
28 | dense.dense_blocks.1 | Linear              | 1.0 M  | [4, 1024]           | [4, 1024]         
29 | dense.dense_blocks.2 | Linear              | 524 K  | [4, 1024]           | [4, 512]          
30 | dense.dense_blocks.3 | Linear              | 262 K  | [4, 512]            | [4, 512]          
31 | dense.fc_boneage     | Linear              | 513    | [4, 512]            | [4, 1]            
32 | dense.fc_sex         | Linear              | 513    | [4, 512]            | [4, 1]            
33 | loss                 | MultiTaskLoss       | 0      | ?                   | ?                 
34 | loss.age_loss        | MSELoss             | 0      | ?                   | ?                 
35 | loss.sex_loss        | BCEWithLogitsLoss   | 0      | ?                   | ?                 
---------------------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:21:14	INFO	early_stopping.py	Monitored metric Step-wise/val_mad = nan is not finite. Previous best value was inf. Signaling Trainer to stop.
23 Jun 22 18:21:14	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached inf (best inf), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_0/ckp/best_model.ckpt' as top 1
23 Jun 22 18:21:17	INFO	cli.py	===== Training finished ======
23 Jun 22 18:21:17	INFO	cli.py	Training time : 1.40min for 100 steps of training
23 Jun 22 18:21:17	INFO	cli.py	Training speed: 1.19 steps/second
23 Jun 22 18:21:17	INFO	train_model.py	========== Testing model ==========
23 Jun 22 18:21:17	INFO	cli.py	Using last obtained model
23 Jun 22 18:21:17	INFO	testing.py	====== Testing model =====
23 Jun 22 18:21:17	INFO	testing.py	Starting inference
23 Jun 22 18:21:18	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_0/ckp/last.ckpt
23 Jun 22 18:21:18	INFO	testing.py	normalizing images with: zscore
23 Jun 22 18:21:18	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:21:18	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:21:19	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:21:19	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:21:54	INFO	seed.py	Global seed set to 42
23 Jun 22 18:21:54	INFO	datasets.py	found 12610 train images
23 Jun 22 18:21:54	INFO	datasets.py	found 1425 val images
23 Jun 22 18:21:54	INFO	datasets.py	found 200 test images
23 Jun 22 18:21:54	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 18:21:54	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:21:56	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 18:21:57	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 18:21:57	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 18:21:57	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 18:21:57	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:21:58	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:21:58	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:21:58	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:21:58	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 18:21:58	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:21:58	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 18:21:58	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 18:21:58	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 18:21:59	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 18:21:59	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 18:21:59	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 18:21:59	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 18:21:59	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 18:21:59	INFO	cli.py	Output directory set to output/debug/version_1
23 Jun 22 18:21:59	INFO	log.py	Logs saved to run.log
23 Jun 22 18:21:59	INFO	log.py	Core count             = 12
23 Jun 22 18:21:59	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 18:21:59	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 18:21:59	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 18:21:59	INFO	log.py	CUDA version           = 11.3
23 Jun 22 18:21:59	INFO	log.py	CUDA count             = 1
23 Jun 22 18:21:59	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 18:22:09	INFO	train_model.py	========== start training ==========
23 Jun 22 18:22:11	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 18:22:11	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | Inceptionv3Backbone | 21.8 M | ?                   | ?               
1 | dense    | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss       | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:22:11	INFO	model_summary.py	
   | Name                 | Type                | Params | In sizes            | Out sizes         
---------------------------------------------------------------------------------------------------------
0  | backbone             | Inceptionv3Backbone | 21.8 M | ?                   | ?                 
1  | backbone.features    | Sequential          | 21.8 M | [4, 1, 512, 512]    | [4, 2048, 1, 1]   
2  | backbone.features.0  | Conv2d              | 320    | [4, 1, 512, 512]    | [4, 32, 255, 255] 
3  | backbone.features.1  | BatchNorm2d         | 64     | [4, 32, 255, 255]   | [4, 32, 255, 255] 
4  | backbone.features.2  | BasicConv2d         | 9.3 K  | [4, 32, 255, 255]   | [4, 32, 253, 253] 
5  | backbone.features.3  | BasicConv2d         | 18.6 K | [4, 32, 253, 253]   | [4, 64, 253, 253] 
6  | backbone.features.4  | MaxPool2d           | 0      | [4, 64, 253, 253]   | [4, 64, 126, 126] 
7  | backbone.features.5  | BasicConv2d         | 5.3 K  | [4, 64, 126, 126]   | [4, 80, 126, 126] 
8  | backbone.features.6  | BasicConv2d         | 138 K  | [4, 80, 126, 126]   | [4, 192, 124, 124]
9  | backbone.features.7  | MaxPool2d           | 0      | [4, 192, 124, 124]  | [4, 192, 61, 61]  
10 | backbone.features.8  | InceptionA          | 255 K  | [4, 192, 61, 61]    | [4, 256, 61, 61]  
11 | backbone.features.9  | InceptionA          | 277 K  | [4, 256, 61, 61]    | [4, 288, 61, 61]  
12 | backbone.features.10 | InceptionA          | 285 K  | [4, 288, 61, 61]    | [4, 288, 61, 61]  
13 | backbone.features.11 | InceptionB          | 1.2 M  | [4, 288, 61, 61]    | [4, 768, 30, 30]  
14 | backbone.features.12 | InceptionC          | 1.3 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
15 | backbone.features.13 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
16 | backbone.features.14 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
17 | backbone.features.15 | InceptionC          | 2.1 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
18 | backbone.features.16 | InceptionD          | 1.7 M  | [4, 768, 30, 30]    | [4, 1280, 14, 14] 
19 | backbone.features.17 | InceptionE          | 5.0 M  | [4, 1280, 14, 14]   | [4, 2048, 14, 14] 
20 | backbone.features.18 | InceptionE          | 6.1 M  | [4, 2048, 14, 14]   | [4, 2048, 14, 14] 
21 | backbone.features.19 | AdaptiveAvgPool2d   | 0      | [4, 2048, 14, 14]   | [4, 2048, 1, 1]   
22 | dense                | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]  
23 | dense.dropout        | Dropout             | 0      | [4, 1024]           | [4, 1024]         
24 | dense.fc_gender_in   | Linear              | 64     | [4, 1]              | [4, 32]           
25 | dense.act            | ReLU                | 0      | [4, 32]             | [4, 32]           
26 | dense.dense_blocks   | ModuleList          | 4.0 M  | ?                   | ?                 
27 | dense.dense_blocks.0 | Linear              | 2.1 M  | [4, 2080]           | [4, 1024]         
28 | dense.dense_blocks.1 | Linear              | 1.0 M  | [4, 1024]           | [4, 1024]         
29 | dense.dense_blocks.2 | Linear              | 524 K  | [4, 1024]           | [4, 512]          
30 | dense.dense_blocks.3 | Linear              | 262 K  | [4, 512]            | [4, 512]          
31 | dense.fc_boneage     | Linear              | 513    | [4, 512]            | [4, 1]            
32 | dense.fc_sex         | Linear              | 513    | [4, 512]            | [4, 1]            
33 | loss                 | MultiTaskLoss       | 0      | ?                   | ?                 
34 | loss.age_loss        | MSELoss             | 0      | ?                   | ?                 
35 | loss.sex_loss        | BCEWithLogitsLoss   | 0      | ?                   | ?                 
---------------------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:26:31	INFO	cli.py	===== Training finished ======
23 Jun 22 18:26:31	INFO	cli.py	Training time : 4.36min for 1 steps of training
23 Jun 22 18:26:31	INFO	cli.py	Training speed: 0.00 steps/second
23 Jun 22 18:26:31	INFO	train_model.py	========== Testing model ==========
23 Jun 22 18:26:31	INFO	cli.py	Using last obtained model
23 Jun 22 18:26:31	INFO	testing.py	====== Testing model =====
23 Jun 22 18:26:31	INFO	testing.py	Starting inference
23 Jun 22 18:26:37	INFO	seed.py	Global seed set to 42
23 Jun 22 18:26:37	INFO	datasets.py	found 12610 train images
23 Jun 22 18:26:37	INFO	datasets.py	found 1425 val images
23 Jun 22 18:26:37	INFO	datasets.py	found 200 test images
23 Jun 22 18:26:37	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 18:26:37	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:26:38	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 18:26:40	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 18:26:40	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 18:26:40	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 18:26:40	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:26:40	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:26:40	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:26:40	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:26:40	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 18:26:40	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:26:40	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 18:26:40	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 18:26:40	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 18:26:41	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 18:26:41	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 18:26:41	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 18:26:41	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 18:26:41	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 18:26:41	INFO	cli.py	Output directory set to output/debug/version_2
23 Jun 22 18:26:41	INFO	log.py	Logs saved to run.log
23 Jun 22 18:26:41	INFO	log.py	Core count             = 12
23 Jun 22 18:26:41	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 18:26:41	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 18:26:41	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 18:26:41	INFO	log.py	CUDA version           = 11.3
23 Jun 22 18:26:41	INFO	log.py	CUDA count             = 1
23 Jun 22 18:26:41	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 18:26:49	INFO	train_model.py	========== start training ==========
23 Jun 22 18:26:53	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 18:26:53	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | Inceptionv3Backbone | 21.8 M | ?                   | ?               
1 | dense    | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss       | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:26:53	INFO	model_summary.py	
   | Name                 | Type                | Params | In sizes            | Out sizes         
---------------------------------------------------------------------------------------------------------
0  | backbone             | Inceptionv3Backbone | 21.8 M | ?                   | ?                 
1  | backbone.features    | Sequential          | 21.8 M | [4, 1, 512, 512]    | [4, 2048, 1, 1]   
2  | backbone.features.0  | Conv2d              | 320    | [4, 1, 512, 512]    | [4, 32, 255, 255] 
3  | backbone.features.1  | BatchNorm2d         | 64     | [4, 32, 255, 255]   | [4, 32, 255, 255] 
4  | backbone.features.2  | BasicConv2d         | 9.3 K  | [4, 32, 255, 255]   | [4, 32, 253, 253] 
5  | backbone.features.3  | BasicConv2d         | 18.6 K | [4, 32, 253, 253]   | [4, 64, 253, 253] 
6  | backbone.features.4  | MaxPool2d           | 0      | [4, 64, 253, 253]   | [4, 64, 126, 126] 
7  | backbone.features.5  | BasicConv2d         | 5.3 K  | [4, 64, 126, 126]   | [4, 80, 126, 126] 
8  | backbone.features.6  | BasicConv2d         | 138 K  | [4, 80, 126, 126]   | [4, 192, 124, 124]
9  | backbone.features.7  | MaxPool2d           | 0      | [4, 192, 124, 124]  | [4, 192, 61, 61]  
10 | backbone.features.8  | InceptionA          | 255 K  | [4, 192, 61, 61]    | [4, 256, 61, 61]  
11 | backbone.features.9  | InceptionA          | 277 K  | [4, 256, 61, 61]    | [4, 288, 61, 61]  
12 | backbone.features.10 | InceptionA          | 285 K  | [4, 288, 61, 61]    | [4, 288, 61, 61]  
13 | backbone.features.11 | InceptionB          | 1.2 M  | [4, 288, 61, 61]    | [4, 768, 30, 30]  
14 | backbone.features.12 | InceptionC          | 1.3 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
15 | backbone.features.13 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
16 | backbone.features.14 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
17 | backbone.features.15 | InceptionC          | 2.1 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
18 | backbone.features.16 | InceptionD          | 1.7 M  | [4, 768, 30, 30]    | [4, 1280, 14, 14] 
19 | backbone.features.17 | InceptionE          | 5.0 M  | [4, 1280, 14, 14]   | [4, 2048, 14, 14] 
20 | backbone.features.18 | InceptionE          | 6.1 M  | [4, 2048, 14, 14]   | [4, 2048, 14, 14] 
21 | backbone.features.19 | AdaptiveAvgPool2d   | 0      | [4, 2048, 14, 14]   | [4, 2048, 1, 1]   
22 | dense                | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]  
23 | dense.dropout        | Dropout             | 0      | [4, 1024]           | [4, 1024]         
24 | dense.fc_gender_in   | Linear              | 64     | [4, 1]              | [4, 32]           
25 | dense.act            | ReLU                | 0      | [4, 32]             | [4, 32]           
26 | dense.dense_blocks   | ModuleList          | 4.0 M  | ?                   | ?                 
27 | dense.dense_blocks.0 | Linear              | 2.1 M  | [4, 2080]           | [4, 1024]         
28 | dense.dense_blocks.1 | Linear              | 1.0 M  | [4, 1024]           | [4, 1024]         
29 | dense.dense_blocks.2 | Linear              | 524 K  | [4, 1024]           | [4, 512]          
30 | dense.dense_blocks.3 | Linear              | 262 K  | [4, 512]            | [4, 512]          
31 | dense.fc_boneage     | Linear              | 513    | [4, 512]            | [4, 1]            
32 | dense.fc_sex         | Linear              | 513    | [4, 512]            | [4, 1]            
33 | loss                 | MultiTaskLoss       | 0      | ?                   | ?                 
34 | loss.age_loss        | MSELoss             | 0      | ?                   | ?                 
35 | loss.sex_loss        | BCEWithLogitsLoss   | 0      | ?                   | ?                 
---------------------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:28:13	INFO	cli.py	===== Training finished ======
23 Jun 22 18:28:13	INFO	cli.py	Training time : 1.37min for 0 steps of training
23 Jun 22 18:28:13	INFO	cli.py	Training speed: 0.00 steps/second
23 Jun 22 18:28:13	INFO	train_model.py	========== Testing model ==========
23 Jun 22 18:28:13	INFO	cli.py	Using last obtained model
23 Jun 22 18:28:13	INFO	testing.py	====== Testing model =====
23 Jun 22 18:28:13	INFO	testing.py	Starting inference
23 Jun 22 18:28:19	INFO	seed.py	Global seed set to 42
23 Jun 22 18:28:19	INFO	datasets.py	found 12610 train images
23 Jun 22 18:28:19	INFO	datasets.py	found 1425 val images
23 Jun 22 18:28:19	INFO	datasets.py	found 200 test images
23 Jun 22 18:28:19	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 18:28:19	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:28:20	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 18:28:22	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 18:28:22	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 18:28:22	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 18:28:22	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:28:22	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:28:22	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:28:22	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:28:22	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 18:28:22	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:28:22	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 18:28:22	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 18:28:22	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 18:28:23	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 18:28:23	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 18:28:23	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 18:28:23	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 18:28:23	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 18:28:23	INFO	cli.py	Output directory set to output/debug/version_3
23 Jun 22 18:28:23	INFO	log.py	Logs saved to run.log
23 Jun 22 18:28:23	INFO	log.py	Core count             = 12
23 Jun 22 18:28:23	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 18:28:23	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 18:28:23	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 18:28:23	INFO	log.py	CUDA version           = 11.3
23 Jun 22 18:28:23	INFO	log.py	CUDA count             = 1
23 Jun 22 18:28:23	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 18:28:31	INFO	train_model.py	========== start training ==========
23 Jun 22 18:28:35	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 18:28:35	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | Inceptionv3Backbone | 21.8 M | ?                   | ?               
1 | dense    | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss       | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:28:35	INFO	model_summary.py	
   | Name                 | Type                | Params | In sizes            | Out sizes         
---------------------------------------------------------------------------------------------------------
0  | backbone             | Inceptionv3Backbone | 21.8 M | ?                   | ?                 
1  | backbone.features    | Sequential          | 21.8 M | [4, 1, 512, 512]    | [4, 2048, 1, 1]   
2  | backbone.features.0  | Conv2d              | 320    | [4, 1, 512, 512]    | [4, 32, 255, 255] 
3  | backbone.features.1  | BatchNorm2d         | 64     | [4, 32, 255, 255]   | [4, 32, 255, 255] 
4  | backbone.features.2  | BasicConv2d         | 9.3 K  | [4, 32, 255, 255]   | [4, 32, 253, 253] 
5  | backbone.features.3  | BasicConv2d         | 18.6 K | [4, 32, 253, 253]   | [4, 64, 253, 253] 
6  | backbone.features.4  | MaxPool2d           | 0      | [4, 64, 253, 253]   | [4, 64, 126, 126] 
7  | backbone.features.5  | BasicConv2d         | 5.3 K  | [4, 64, 126, 126]   | [4, 80, 126, 126] 
8  | backbone.features.6  | BasicConv2d         | 138 K  | [4, 80, 126, 126]   | [4, 192, 124, 124]
9  | backbone.features.7  | MaxPool2d           | 0      | [4, 192, 124, 124]  | [4, 192, 61, 61]  
10 | backbone.features.8  | InceptionA          | 255 K  | [4, 192, 61, 61]    | [4, 256, 61, 61]  
11 | backbone.features.9  | InceptionA          | 277 K  | [4, 256, 61, 61]    | [4, 288, 61, 61]  
12 | backbone.features.10 | InceptionA          | 285 K  | [4, 288, 61, 61]    | [4, 288, 61, 61]  
13 | backbone.features.11 | InceptionB          | 1.2 M  | [4, 288, 61, 61]    | [4, 768, 30, 30]  
14 | backbone.features.12 | InceptionC          | 1.3 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
15 | backbone.features.13 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
16 | backbone.features.14 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
17 | backbone.features.15 | InceptionC          | 2.1 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
18 | backbone.features.16 | InceptionD          | 1.7 M  | [4, 768, 30, 30]    | [4, 1280, 14, 14] 
19 | backbone.features.17 | InceptionE          | 5.0 M  | [4, 1280, 14, 14]   | [4, 2048, 14, 14] 
20 | backbone.features.18 | InceptionE          | 6.1 M  | [4, 2048, 14, 14]   | [4, 2048, 14, 14] 
21 | backbone.features.19 | AdaptiveAvgPool2d   | 0      | [4, 2048, 14, 14]   | [4, 2048, 1, 1]   
22 | dense                | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]  
23 | dense.dropout        | Dropout             | 0      | [4, 1024]           | [4, 1024]         
24 | dense.fc_gender_in   | Linear              | 64     | [4, 1]              | [4, 32]           
25 | dense.act            | ReLU                | 0      | [4, 32]             | [4, 32]           
26 | dense.dense_blocks   | ModuleList          | 4.0 M  | ?                   | ?                 
27 | dense.dense_blocks.0 | Linear              | 2.1 M  | [4, 2080]           | [4, 1024]         
28 | dense.dense_blocks.1 | Linear              | 1.0 M  | [4, 1024]           | [4, 1024]         
29 | dense.dense_blocks.2 | Linear              | 524 K  | [4, 1024]           | [4, 512]          
30 | dense.dense_blocks.3 | Linear              | 262 K  | [4, 512]            | [4, 512]          
31 | dense.fc_boneage     | Linear              | 513    | [4, 512]            | [4, 1]            
32 | dense.fc_sex         | Linear              | 513    | [4, 512]            | [4, 1]            
33 | loss                 | MultiTaskLoss       | 0      | ?                   | ?                 
34 | loss.age_loss        | MSELoss             | 0      | ?                   | ?                 
35 | loss.sex_loss        | BCEWithLogitsLoss   | 0      | ?                   | ?                 
---------------------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:29:58	INFO	cli.py	===== Training finished ======
23 Jun 22 18:29:58	INFO	cli.py	Training time : 1.42min for 0 steps of training
23 Jun 22 18:29:58	INFO	cli.py	Training speed: 0.00 steps/second
23 Jun 22 18:29:58	INFO	train_model.py	========== Testing model ==========
23 Jun 22 18:29:58	INFO	cli.py	Using last obtained model
23 Jun 22 18:29:58	INFO	testing.py	====== Testing model =====
23 Jun 22 18:29:58	INFO	testing.py	Starting inference
23 Jun 22 18:30:04	INFO	seed.py	Global seed set to 42
23 Jun 22 18:30:04	INFO	datasets.py	found 12610 train images
23 Jun 22 18:30:04	INFO	datasets.py	found 1425 val images
23 Jun 22 18:30:04	INFO	datasets.py	found 200 test images
23 Jun 22 18:30:04	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 18:30:04	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:30:05	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 18:30:07	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 18:30:07	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 18:30:07	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 18:30:07	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:30:07	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:30:07	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:30:07	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:30:07	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 18:30:07	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:30:07	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 18:30:07	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 18:30:07	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 18:30:08	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 18:30:08	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 18:30:08	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 18:30:08	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 18:30:08	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 18:30:08	INFO	cli.py	Output directory set to output/debug/version_4
23 Jun 22 18:30:08	INFO	log.py	Logs saved to run.log
23 Jun 22 18:30:08	INFO	log.py	Core count             = 12
23 Jun 22 18:30:08	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 18:30:08	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 18:30:08	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 18:30:08	INFO	log.py	CUDA version           = 11.3
23 Jun 22 18:30:08	INFO	log.py	CUDA count             = 1
23 Jun 22 18:30:08	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 18:30:16	INFO	train_model.py	========== start training ==========
23 Jun 22 18:30:59	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 18:32:48	INFO	cli.py	===== Training finished ======
23 Jun 22 18:32:48	INFO	cli.py	Training time : 1.86min for 0 steps of training
23 Jun 22 18:32:48	INFO	cli.py	Training speed: 0.00 steps/second
23 Jun 22 18:32:48	INFO	train_model.py	========== Testing model ==========
23 Jun 22 18:32:48	INFO	cli.py	Using last obtained model
23 Jun 22 18:32:48	INFO	testing.py	====== Testing model =====
23 Jun 22 18:32:48	INFO	testing.py	Starting inference
23 Jun 22 18:32:54	INFO	seed.py	Global seed set to 42
23 Jun 22 18:32:54	INFO	datasets.py	found 12610 train images
23 Jun 22 18:32:54	INFO	datasets.py	found 1425 val images
23 Jun 22 18:32:54	INFO	datasets.py	found 200 test images
23 Jun 22 18:32:54	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 18:32:54	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:32:56	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 18:32:57	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 18:32:57	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 18:32:58	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 18:32:58	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:32:58	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:32:58	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:32:58	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:32:58	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 18:32:58	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:32:58	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 18:32:58	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 18:32:58	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 18:35:42	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 18:35:42	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 18:35:42	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 18:35:42	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 18:35:42	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 18:35:42	INFO	cli.py	Output directory set to output/debug/version_5
23 Jun 22 18:35:42	INFO	log.py	Logs saved to run.log
23 Jun 22 18:35:42	INFO	log.py	Core count             = 12
23 Jun 22 18:35:42	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 18:35:42	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 18:35:42	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 18:35:42	INFO	log.py	CUDA version           = 11.3
23 Jun 22 18:35:42	INFO	log.py	CUDA count             = 1
23 Jun 22 18:35:42	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 18:35:49	INFO	train_model.py	========== start training ==========
23 Jun 22 18:35:53	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 18:37:31	INFO	cli.py	===== Training finished ======
23 Jun 22 18:37:31	INFO	cli.py	Training time : 1.66min for 0 steps of training
23 Jun 22 18:37:31	INFO	cli.py	Training speed: 0.00 steps/second
23 Jun 22 18:37:31	INFO	train_model.py	========== Testing model ==========
23 Jun 22 18:37:31	INFO	cli.py	Using last obtained model
23 Jun 22 18:37:31	INFO	testing.py	====== Testing model =====
23 Jun 22 18:37:31	INFO	testing.py	Starting inference
23 Jun 22 18:37:36	INFO	seed.py	Global seed set to 42
23 Jun 22 18:37:36	INFO	datasets.py	found 12610 train images
23 Jun 22 18:37:36	INFO	datasets.py	found 1425 val images
23 Jun 22 18:37:36	INFO	datasets.py	found 200 test images
23 Jun 22 18:37:36	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 18:37:36	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:37:38	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 18:37:39	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 18:37:39	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 18:37:39	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 18:37:39	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:37:40	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:37:40	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:37:40	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:37:40	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 18:37:40	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:37:40	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 18:37:40	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 18:37:40	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 18:37:40	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 18:37:40	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 18:37:40	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 18:37:40	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 18:37:40	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 18:37:40	INFO	cli.py	Output directory set to output/debug/version_6
23 Jun 22 18:37:40	INFO	log.py	Logs saved to run.log
23 Jun 22 18:37:40	INFO	log.py	Core count             = 12
23 Jun 22 18:37:40	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 18:37:40	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 18:37:40	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 18:37:40	INFO	log.py	CUDA version           = 11.3
23 Jun 22 18:37:40	INFO	log.py	CUDA count             = 1
23 Jun 22 18:37:40	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 18:37:48	INFO	train_model.py	========== start training ==========
23 Jun 22 18:38:31	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 18:41:13	INFO	cli.py	===== Training finished ======
23 Jun 22 18:41:13	INFO	cli.py	Training time : 2.74min for 0 steps of training
23 Jun 22 18:41:13	INFO	cli.py	Training speed: 0.00 steps/second
23 Jun 22 18:41:13	INFO	train_model.py	========== Testing model ==========
23 Jun 22 18:41:13	INFO	cli.py	Using last obtained model
23 Jun 22 18:41:13	INFO	testing.py	====== Testing model =====
23 Jun 22 18:41:13	INFO	testing.py	Starting inference
23 Jun 22 18:41:19	INFO	seed.py	Global seed set to 42
23 Jun 22 18:41:19	INFO	datasets.py	found 12610 train images
23 Jun 22 18:41:19	INFO	datasets.py	found 1425 val images
23 Jun 22 18:41:19	INFO	datasets.py	found 200 test images
23 Jun 22 18:41:19	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 18:41:19	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:41:21	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 18:41:22	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 18:41:22	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 18:41:22	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 18:41:22	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:41:22	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:41:23	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:41:23	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:41:23	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 18:41:23	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:41:23	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 18:41:23	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 18:41:23	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 18:41:23	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 18:41:23	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 18:41:23	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 18:41:23	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 18:41:23	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 18:41:23	INFO	cli.py	Output directory set to output/debug/version_7
23 Jun 22 18:41:23	INFO	log.py	Logs saved to run.log
23 Jun 22 18:41:23	INFO	log.py	Core count             = 12
23 Jun 22 18:41:23	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 18:41:23	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 18:41:23	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 18:41:23	INFO	log.py	CUDA version           = 11.3
23 Jun 22 18:41:23	INFO	log.py	CUDA count             = 1
23 Jun 22 18:41:23	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 18:41:31	INFO	train_model.py	========== start training ==========
23 Jun 22 18:41:35	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 18:41:35	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 18:41:35	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 0      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 18:42:45	INFO	cli.py	===== Training finished ======
23 Jun 22 18:42:45	INFO	cli.py	Training time : 1.20min for 50 steps of training
23 Jun 22 18:42:45	INFO	cli.py	Training speed: 0.69 steps/second
23 Jun 22 18:42:45	INFO	train_model.py	========== Testing model ==========
23 Jun 22 18:42:45	INFO	cli.py	Using last obtained model
23 Jun 22 18:42:45	INFO	testing.py	====== Testing model =====
23 Jun 22 18:42:45	INFO	testing.py	Starting inference
23 Jun 22 18:42:51	INFO	seed.py	Global seed set to 42
23 Jun 22 18:42:51	INFO	datasets.py	found 12610 train images
23 Jun 22 18:42:51	INFO	datasets.py	found 1425 val images
23 Jun 22 18:42:51	INFO	datasets.py	found 200 test images
23 Jun 22 18:42:51	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 18:42:51	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:42:52	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 18:42:54	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 18:42:54	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 18:42:54	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 18:42:54	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:42:54	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:42:54	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:42:54	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:42:54	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 18:42:54	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:42:54	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 18:42:54	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 18:42:54	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 18:42:55	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 18:42:55	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 18:42:55	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 18:42:55	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 18:42:55	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 18:42:55	INFO	cli.py	Output directory set to output/debug/version_8
23 Jun 22 18:42:55	INFO	log.py	Logs saved to run.log
23 Jun 22 18:42:55	INFO	log.py	Core count             = 12
23 Jun 22 18:42:55	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 18:42:55	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 18:42:55	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 18:42:55	INFO	log.py	CUDA version           = 11.3
23 Jun 22 18:42:55	INFO	log.py	CUDA count             = 1
23 Jun 22 18:42:55	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 18:43:03	INFO	train_model.py	========== start training ==========
23 Jun 22 18:43:07	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 18:43:07	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | Inceptionv3Backbone | 21.8 M | ?                   | ?               
1 | dense    | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss       | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:43:07	INFO	model_summary.py	
   | Name                 | Type                | Params | In sizes            | Out sizes         
---------------------------------------------------------------------------------------------------------
0  | backbone             | Inceptionv3Backbone | 21.8 M | ?                   | ?                 
1  | backbone.features    | Sequential          | 21.8 M | [4, 1, 512, 512]    | [4, 2048, 1, 1]   
2  | backbone.features.0  | Conv2d              | 320    | [4, 1, 512, 512]    | [4, 32, 255, 255] 
3  | backbone.features.1  | BatchNorm2d         | 64     | [4, 32, 255, 255]   | [4, 32, 255, 255] 
4  | backbone.features.2  | BasicConv2d         | 9.3 K  | [4, 32, 255, 255]   | [4, 32, 253, 253] 
5  | backbone.features.3  | BasicConv2d         | 18.6 K | [4, 32, 253, 253]   | [4, 64, 253, 253] 
6  | backbone.features.4  | MaxPool2d           | 0      | [4, 64, 253, 253]   | [4, 64, 126, 126] 
7  | backbone.features.5  | BasicConv2d         | 5.3 K  | [4, 64, 126, 126]   | [4, 80, 126, 126] 
8  | backbone.features.6  | BasicConv2d         | 138 K  | [4, 80, 126, 126]   | [4, 192, 124, 124]
9  | backbone.features.7  | MaxPool2d           | 0      | [4, 192, 124, 124]  | [4, 192, 61, 61]  
10 | backbone.features.8  | InceptionA          | 255 K  | [4, 192, 61, 61]    | [4, 256, 61, 61]  
11 | backbone.features.9  | InceptionA          | 277 K  | [4, 256, 61, 61]    | [4, 288, 61, 61]  
12 | backbone.features.10 | InceptionA          | 285 K  | [4, 288, 61, 61]    | [4, 288, 61, 61]  
13 | backbone.features.11 | InceptionB          | 1.2 M  | [4, 288, 61, 61]    | [4, 768, 30, 30]  
14 | backbone.features.12 | InceptionC          | 1.3 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
15 | backbone.features.13 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
16 | backbone.features.14 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
17 | backbone.features.15 | InceptionC          | 2.1 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
18 | backbone.features.16 | InceptionD          | 1.7 M  | [4, 768, 30, 30]    | [4, 1280, 14, 14] 
19 | backbone.features.17 | InceptionE          | 5.0 M  | [4, 1280, 14, 14]   | [4, 2048, 14, 14] 
20 | backbone.features.18 | InceptionE          | 6.1 M  | [4, 2048, 14, 14]   | [4, 2048, 14, 14] 
21 | backbone.features.19 | AdaptiveAvgPool2d   | 0      | [4, 2048, 14, 14]   | [4, 2048, 1, 1]   
22 | dense                | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]  
23 | dense.dropout        | Dropout             | 0      | [4, 1024]           | [4, 1024]         
24 | dense.fc_gender_in   | Linear              | 64     | [4, 1]              | [4, 32]           
25 | dense.act            | ReLU                | 0      | [4, 32]             | [4, 32]           
26 | dense.dense_blocks   | ModuleList          | 4.0 M  | ?                   | ?                 
27 | dense.dense_blocks.0 | Linear              | 2.1 M  | [4, 2080]           | [4, 1024]         
28 | dense.dense_blocks.1 | Linear              | 1.0 M  | [4, 1024]           | [4, 1024]         
29 | dense.dense_blocks.2 | Linear              | 524 K  | [4, 1024]           | [4, 512]          
30 | dense.dense_blocks.3 | Linear              | 262 K  | [4, 512]            | [4, 512]          
31 | dense.fc_boneage     | Linear              | 513    | [4, 512]            | [4, 1]            
32 | dense.fc_sex         | Linear              | 513    | [4, 512]            | [4, 1]            
33 | loss                 | MultiTaskLoss       | 0      | ?                   | ?                 
34 | loss.age_loss        | MSELoss             | 0      | ?                   | ?                 
35 | loss.sex_loss        | BCEWithLogitsLoss   | 0      | ?                   | ?                 
---------------------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:44:25	INFO	early_stopping.py	Monitored metric Step-wise/val_mad = nan is not finite. Previous best value was inf. Signaling Trainer to stop.
23 Jun 22 18:44:25	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached inf (best inf), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_8/ckp/best_model.ckpt' as top 1
23 Jun 22 18:44:29	INFO	cli.py	===== Training finished ======
23 Jun 22 18:44:29	INFO	cli.py	Training time : 1.40min for 100 steps of training
23 Jun 22 18:44:29	INFO	cli.py	Training speed: 1.19 steps/second
23 Jun 22 18:44:29	INFO	train_model.py	========== Testing model ==========
23 Jun 22 18:44:29	INFO	cli.py	Using last obtained model
23 Jun 22 18:44:29	INFO	testing.py	====== Testing model =====
23 Jun 22 18:44:29	INFO	testing.py	Starting inference
23 Jun 22 18:44:30	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_8/ckp/last.ckpt
23 Jun 22 18:44:30	INFO	testing.py	normalizing images with: zscore
23 Jun 22 18:44:30	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:44:30	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:44:30	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:44:30	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:44:48	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:44:48	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:44:48	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:44:48	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:45:06	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:45:06	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:45:07	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:45:07	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:45:24	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:45:25	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:45:25	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:45:25	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:45:43	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:45:43	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:45:43	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:45:43	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:46:00	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:46:00	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:46:00	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:46:00	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:49:59	INFO	seed.py	Global seed set to 42
23 Jun 22 18:49:59	INFO	datasets.py	found 12610 train images
23 Jun 22 18:49:59	INFO	datasets.py	found 1425 val images
23 Jun 22 18:49:59	INFO	datasets.py	found 200 test images
23 Jun 22 18:49:59	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 18:49:59	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:50:01	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 18:50:03	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 18:50:03	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 18:50:03	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 18:50:03	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:50:03	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:50:03	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:50:03	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:50:03	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 18:50:03	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:50:03	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 18:50:03	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 18:50:03	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 18:50:47	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 18:50:47	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 18:50:47	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 18:50:47	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 18:50:47	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 18:50:47	INFO	cli.py	Output directory set to output/debug/version_9
23 Jun 22 18:50:47	INFO	log.py	Logs saved to run.log
23 Jun 22 18:50:47	INFO	log.py	Core count             = 12
23 Jun 22 18:50:47	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 18:50:47	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 18:50:47	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 18:50:47	INFO	log.py	CUDA version           = 11.3
23 Jun 22 18:50:47	INFO	log.py	CUDA count             = 1
23 Jun 22 18:50:47	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 18:50:57	INFO	train_model.py	========== start training ==========
23 Jun 22 18:51:00	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 18:52:02	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | Inceptionv3Backbone | 21.8 M | ?                   | ?               
1 | dense    | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss       | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:52:05	INFO	model_summary.py	
   | Name                 | Type                | Params | In sizes            | Out sizes         
---------------------------------------------------------------------------------------------------------
0  | backbone             | Inceptionv3Backbone | 21.8 M | ?                   | ?                 
1  | backbone.features    | Sequential          | 21.8 M | [4, 1, 512, 512]    | [4, 2048, 1, 1]   
2  | backbone.features.0  | Conv2d              | 320    | [4, 1, 512, 512]    | [4, 32, 255, 255] 
3  | backbone.features.1  | BatchNorm2d         | 64     | [4, 32, 255, 255]   | [4, 32, 255, 255] 
4  | backbone.features.2  | BasicConv2d         | 9.3 K  | [4, 32, 255, 255]   | [4, 32, 253, 253] 
5  | backbone.features.3  | BasicConv2d         | 18.6 K | [4, 32, 253, 253]   | [4, 64, 253, 253] 
6  | backbone.features.4  | MaxPool2d           | 0      | [4, 64, 253, 253]   | [4, 64, 126, 126] 
7  | backbone.features.5  | BasicConv2d         | 5.3 K  | [4, 64, 126, 126]   | [4, 80, 126, 126] 
8  | backbone.features.6  | BasicConv2d         | 138 K  | [4, 80, 126, 126]   | [4, 192, 124, 124]
9  | backbone.features.7  | MaxPool2d           | 0      | [4, 192, 124, 124]  | [4, 192, 61, 61]  
10 | backbone.features.8  | InceptionA          | 255 K  | [4, 192, 61, 61]    | [4, 256, 61, 61]  
11 | backbone.features.9  | InceptionA          | 277 K  | [4, 256, 61, 61]    | [4, 288, 61, 61]  
12 | backbone.features.10 | InceptionA          | 285 K  | [4, 288, 61, 61]    | [4, 288, 61, 61]  
13 | backbone.features.11 | InceptionB          | 1.2 M  | [4, 288, 61, 61]    | [4, 768, 30, 30]  
14 | backbone.features.12 | InceptionC          | 1.3 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
15 | backbone.features.13 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
16 | backbone.features.14 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
17 | backbone.features.15 | InceptionC          | 2.1 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
18 | backbone.features.16 | InceptionD          | 1.7 M  | [4, 768, 30, 30]    | [4, 1280, 14, 14] 
19 | backbone.features.17 | InceptionE          | 5.0 M  | [4, 1280, 14, 14]   | [4, 2048, 14, 14] 
20 | backbone.features.18 | InceptionE          | 6.1 M  | [4, 2048, 14, 14]   | [4, 2048, 14, 14] 
21 | backbone.features.19 | AdaptiveAvgPool2d   | 0      | [4, 2048, 14, 14]   | [4, 2048, 1, 1]   
22 | dense                | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]  
23 | dense.dropout        | Dropout             | 0      | [4, 1024]           | [4, 1024]         
24 | dense.fc_gender_in   | Linear              | 64     | [4, 1]              | [4, 32]           
25 | dense.act            | ReLU                | 0      | [4, 32]             | [4, 32]           
26 | dense.dense_blocks   | ModuleList          | 4.0 M  | ?                   | ?                 
27 | dense.dense_blocks.0 | Linear              | 2.1 M  | [4, 2080]           | [4, 1024]         
28 | dense.dense_blocks.1 | Linear              | 1.0 M  | [4, 1024]           | [4, 1024]         
29 | dense.dense_blocks.2 | Linear              | 524 K  | [4, 1024]           | [4, 512]          
30 | dense.dense_blocks.3 | Linear              | 262 K  | [4, 512]            | [4, 512]          
31 | dense.fc_boneage     | Linear              | 513    | [4, 512]            | [4, 1]            
32 | dense.fc_sex         | Linear              | 513    | [4, 512]            | [4, 1]            
33 | loss                 | MultiTaskLoss       | 0      | ?                   | ?                 
34 | loss.age_loss        | MSELoss             | 0      | ?                   | ?                 
35 | loss.sex_loss        | BCEWithLogitsLoss   | 0      | ?                   | ?                 
---------------------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 18:59:08	INFO	cli.py	===== Training finished ======
23 Jun 22 18:59:08	INFO	cli.py	Training time : 8.18min for 0 steps of training
23 Jun 22 18:59:08	INFO	cli.py	Training speed: 0.00 steps/second
23 Jun 22 18:59:08	INFO	train_model.py	========== Testing model ==========
23 Jun 22 18:59:08	INFO	cli.py	Using last obtained model
23 Jun 22 18:59:08	INFO	testing.py	====== Testing model =====
23 Jun 22 18:59:08	INFO	testing.py	Starting inference
23 Jun 22 18:59:14	INFO	seed.py	Global seed set to 42
23 Jun 22 18:59:14	INFO	datasets.py	found 12610 train images
23 Jun 22 18:59:14	INFO	datasets.py	found 1425 val images
23 Jun 22 18:59:14	INFO	datasets.py	found 200 test images
23 Jun 22 18:59:14	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 18:59:14	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:59:16	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 18:59:17	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 18:59:17	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 18:59:17	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 18:59:17	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:59:17	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 18:59:17	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 18:59:17	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 18:59:17	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 18:59:17	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 18:59:18	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 18:59:18	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 18:59:18	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 18:59:27	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 18:59:27	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 18:59:27	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 18:59:27	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 18:59:27	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 18:59:27	INFO	cli.py	Output directory set to output/debug/version_10
23 Jun 22 18:59:27	INFO	log.py	Logs saved to run.log
23 Jun 22 18:59:27	INFO	log.py	Core count             = 12
23 Jun 22 18:59:27	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 18:59:27	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 18:59:27	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 18:59:27	INFO	log.py	CUDA version           = 11.3
23 Jun 22 18:59:27	INFO	log.py	CUDA count             = 1
23 Jun 22 18:59:27	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 18:59:35	INFO	train_model.py	========== start training ==========
23 Jun 22 19:00:57	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 19:03:07	INFO	model_summary.py	
  | Name     | Type                | Params | In sizes            | Out sizes       
------------------------------------------------------------------------------------------
0 | backbone | Inceptionv3Backbone | 21.8 M | ?                   | ?               
1 | dense    | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss       | 0      | ?                   | ?               
------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 19:07:27	INFO	model_summary.py	
   | Name                 | Type                | Params | In sizes            | Out sizes         
---------------------------------------------------------------------------------------------------------
0  | backbone             | Inceptionv3Backbone | 21.8 M | ?                   | ?                 
1  | backbone.features    | Sequential          | 21.8 M | [4, 1, 512, 512]    | [4, 2048, 1, 1]   
2  | backbone.features.0  | Conv2d              | 320    | [4, 1, 512, 512]    | [4, 32, 255, 255] 
3  | backbone.features.1  | BatchNorm2d         | 64     | [4, 32, 255, 255]   | [4, 32, 255, 255] 
4  | backbone.features.2  | BasicConv2d         | 9.3 K  | [4, 32, 255, 255]   | [4, 32, 253, 253] 
5  | backbone.features.3  | BasicConv2d         | 18.6 K | [4, 32, 253, 253]   | [4, 64, 253, 253] 
6  | backbone.features.4  | MaxPool2d           | 0      | [4, 64, 253, 253]   | [4, 64, 126, 126] 
7  | backbone.features.5  | BasicConv2d         | 5.3 K  | [4, 64, 126, 126]   | [4, 80, 126, 126] 
8  | backbone.features.6  | BasicConv2d         | 138 K  | [4, 80, 126, 126]   | [4, 192, 124, 124]
9  | backbone.features.7  | MaxPool2d           | 0      | [4, 192, 124, 124]  | [4, 192, 61, 61]  
10 | backbone.features.8  | InceptionA          | 255 K  | [4, 192, 61, 61]    | [4, 256, 61, 61]  
11 | backbone.features.9  | InceptionA          | 277 K  | [4, 256, 61, 61]    | [4, 288, 61, 61]  
12 | backbone.features.10 | InceptionA          | 285 K  | [4, 288, 61, 61]    | [4, 288, 61, 61]  
13 | backbone.features.11 | InceptionB          | 1.2 M  | [4, 288, 61, 61]    | [4, 768, 30, 30]  
14 | backbone.features.12 | InceptionC          | 1.3 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
15 | backbone.features.13 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
16 | backbone.features.14 | InceptionC          | 1.7 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
17 | backbone.features.15 | InceptionC          | 2.1 M  | [4, 768, 30, 30]    | [4, 768, 30, 30]  
18 | backbone.features.16 | InceptionD          | 1.7 M  | [4, 768, 30, 30]    | [4, 1280, 14, 14] 
19 | backbone.features.17 | InceptionE          | 5.0 M  | [4, 1280, 14, 14]   | [4, 2048, 14, 14] 
20 | backbone.features.18 | InceptionE          | 6.1 M  | [4, 2048, 14, 14]   | [4, 2048, 14, 14] 
21 | backbone.features.19 | AdaptiveAvgPool2d   | 0      | [4, 2048, 14, 14]   | [4, 2048, 1, 1]   
22 | dense                | DenseNetwork        | 4.0 M  | [[4, 2048], [4, 1]] | [[4, 1], [4, 1]]  
23 | dense.dropout        | Dropout             | 0      | [4, 1024]           | [4, 1024]         
24 | dense.fc_gender_in   | Linear              | 64     | [4, 1]              | [4, 32]           
25 | dense.act            | ReLU                | 0      | [4, 32]             | [4, 32]           
26 | dense.dense_blocks   | ModuleList          | 4.0 M  | ?                   | ?                 
27 | dense.dense_blocks.0 | Linear              | 2.1 M  | [4, 2080]           | [4, 1024]         
28 | dense.dense_blocks.1 | Linear              | 1.0 M  | [4, 1024]           | [4, 1024]         
29 | dense.dense_blocks.2 | Linear              | 524 K  | [4, 1024]           | [4, 512]          
30 | dense.dense_blocks.3 | Linear              | 262 K  | [4, 512]            | [4, 512]          
31 | dense.fc_boneage     | Linear              | 513    | [4, 512]            | [4, 1]            
32 | dense.fc_sex         | Linear              | 513    | [4, 512]            | [4, 1]            
33 | loss                 | MultiTaskLoss       | 0      | ?                   | ?                 
34 | loss.age_loss        | MSELoss             | 0      | ?                   | ?                 
35 | loss.sex_loss        | BCEWithLogitsLoss   | 0      | ?                   | ?                 
---------------------------------------------------------------------------------------------------------
25.8 M    Trainable params
0         Non-trainable params
25.8 M    Total params
51.508    Total estimated model params size (MB)
23 Jun 22 19:13:16	INFO	cli.py	===== Training finished ======
23 Jun 22 19:13:16	INFO	cli.py	Training time : 12.36min for 0 steps of training
23 Jun 22 19:13:16	INFO	cli.py	Training speed: 0.00 steps/second
23 Jun 22 19:13:16	INFO	train_model.py	========== Testing model ==========
23 Jun 22 19:13:16	INFO	cli.py	Using last obtained model
23 Jun 22 19:13:16	INFO	testing.py	====== Testing model =====
23 Jun 22 19:13:16	INFO	testing.py	Starting inference
23 Jun 22 19:13:22	INFO	seed.py	Global seed set to 42
23 Jun 22 19:13:22	INFO	datasets.py	found 12610 train images
23 Jun 22 19:13:22	INFO	datasets.py	found 1425 val images
23 Jun 22 19:13:22	INFO	datasets.py	found 200 test images
23 Jun 22 19:13:22	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 19:13:22	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:13:24	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 19:13:25	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 19:13:26	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 19:13:26	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 19:13:26	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:13:26	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 19:13:26	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 19:13:26	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 19:13:26	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 19:13:26	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:13:26	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 19:13:26	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 19:13:26	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 19:13:26	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 19:13:26	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 19:13:26	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 19:13:26	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 19:13:26	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 19:13:26	INFO	cli.py	Output directory set to output/debug/version_11
23 Jun 22 19:13:26	INFO	log.py	Logs saved to run.log
23 Jun 22 19:13:26	INFO	log.py	Core count             = 12
23 Jun 22 19:13:26	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 19:13:26	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 19:13:26	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 19:13:26	INFO	log.py	CUDA version           = 11.3
23 Jun 22 19:13:26	INFO	log.py	CUDA count             = 1
23 Jun 22 19:13:26	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 19:13:35	INFO	train_model.py	========== start training ==========
23 Jun 22 19:13:39	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 19:13:39	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 19:13:39	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 0      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 19:14:04	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 24.983
23 Jun 22 19:14:04	INFO	model_checkpoint.py	Epoch 0, global step 10: 'Step-wise/val_mad' reached 24.98261 (best 24.98261), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_11/ckp/best_model.ckpt' as top 1
23 Jun 22 19:14:23	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 24.081 >= min_delta = 0.0. New best score: 0.902
23 Jun 22 19:14:23	INFO	model_checkpoint.py	Epoch 1, global step 20: 'Step-wise/val_mad' reached 0.90154 (best 0.90154), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_11/ckp/best_model.ckpt' as top 1
23 Jun 22 19:14:42	INFO	model_checkpoint.py	Epoch 2, global step 30: 'Step-wise/val_mad' was not in top 1
23 Jun 22 19:15:01	INFO	model_checkpoint.py	Epoch 3, global step 40: 'Step-wise/val_mad' was not in top 1
23 Jun 22 19:15:20	INFO	model_checkpoint.py	Epoch 4, global step 50: 'Step-wise/val_mad' was not in top 1
23 Jun 22 19:15:22	INFO	cli.py	===== Training finished ======
23 Jun 22 19:15:22	INFO	cli.py	Training time : 1.77min for 50 steps of training
23 Jun 22 19:15:22	INFO	cli.py	Training speed: 0.47 steps/second
23 Jun 22 19:15:22	INFO	train_model.py	========== Testing model ==========
23 Jun 22 19:15:22	INFO	cli.py	Using last obtained model
23 Jun 22 19:15:22	INFO	testing.py	====== Testing model =====
23 Jun 22 19:15:22	INFO	testing.py	Starting inference
23 Jun 22 19:15:23	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_11/ckp/last.ckpt
23 Jun 22 19:15:23	INFO	testing.py	normalizing images with: zscore
23 Jun 22 19:15:23	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:15:23	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 19:15:23	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 19:15:23	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 19:15:42	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:15:42	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 19:15:42	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 19:15:42	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 19:16:01	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:16:01	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 19:16:01	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 19:16:01	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 19:18:39	INFO	seed.py	Global seed set to 42
23 Jun 22 19:18:39	INFO	datasets.py	found 12610 train images
23 Jun 22 19:18:39	INFO	datasets.py	found 1425 val images
23 Jun 22 19:18:39	INFO	datasets.py	found 200 test images
23 Jun 22 19:18:39	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 19:18:39	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:18:41	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 19:18:43	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 19:18:43	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 19:18:43	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 19:18:43	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:18:43	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 19:18:43	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 19:18:43	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 19:18:43	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 19:18:43	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:18:43	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 19:18:43	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 19:18:43	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 19:20:00	INFO	seed.py	Global seed set to 42
23 Jun 22 19:30:00	INFO	datasets.py	found 12610 train images
23 Jun 22 19:30:00	INFO	datasets.py	found 1425 val images
23 Jun 22 19:30:00	INFO	datasets.py	found 200 test images
23 Jun 22 19:30:00	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 19:30:00	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:30:02	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 19:30:03	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 19:30:03	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 19:30:03	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 19:30:03	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:30:04	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 19:30:04	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 19:30:04	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 19:30:04	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 19:30:04	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:30:04	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 19:30:04	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 19:30:04	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 19:32:42	INFO	seed.py	Global seed set to 42
23 Jun 22 19:32:42	INFO	datasets.py	found 12610 train images
23 Jun 22 19:32:42	INFO	datasets.py	found 1425 val images
23 Jun 22 19:32:42	INFO	datasets.py	found 200 test images
23 Jun 22 19:32:42	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 19:32:42	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:32:44	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 19:32:45	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 19:32:45	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 19:32:45	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 19:32:45	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:32:46	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 19:32:46	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 19:32:46	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 19:32:46	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 19:32:46	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:32:46	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 19:32:46	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 19:32:46	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 19:33:10	INFO	seed.py	Global seed set to 42
23 Jun 22 19:33:10	INFO	datasets.py	found 12610 train images
23 Jun 22 19:33:10	INFO	datasets.py	found 1425 val images
23 Jun 22 19:33:10	INFO	datasets.py	found 200 test images
23 Jun 22 19:33:10	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 19:33:10	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:33:11	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 19:33:13	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 19:33:13	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 19:33:13	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 19:33:13	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:33:13	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 19:33:13	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 19:33:13	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 19:33:13	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 19:33:13	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:33:13	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 19:33:14	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 19:33:14	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 19:33:22	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 19:33:22	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 19:33:22	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 19:33:22	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 19:33:22	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 19:33:22	INFO	cli.py	Output directory set to output/debug/version_12
23 Jun 22 19:33:22	INFO	log.py	Logs saved to run.log
23 Jun 22 19:33:22	INFO	log.py	Core count             = 12
23 Jun 22 19:33:22	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 19:33:22	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 19:33:22	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 19:33:22	INFO	log.py	CUDA version           = 11.3
23 Jun 22 19:33:22	INFO	log.py	CUDA count             = 1
23 Jun 22 19:33:22	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 19:33:32	INFO	train_model.py	========== start training ==========
23 Jun 22 19:33:35	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 19:33:35	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 19:33:35	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 0      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 19:34:00	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 979.440
23 Jun 22 19:34:00	INFO	model_checkpoint.py	Epoch 0, global step 10: 'Step-wise/val_mad' reached 979.43964 (best 979.43964), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_12/ckp/best_model.ckpt' as top 1
23 Jun 22 19:34:17	INFO	cli.py	===== Training finished ======
23 Jun 22 19:34:17	INFO	cli.py	Training time : 0.75min for 20 steps of training
23 Jun 22 19:34:17	INFO	cli.py	Training speed: 0.44 steps/second
23 Jun 22 19:34:17	INFO	train_model.py	========== Testing model ==========
23 Jun 22 19:34:17	INFO	cli.py	Using last obtained model
23 Jun 22 19:34:17	INFO	testing.py	====== Testing model =====
23 Jun 22 19:34:17	INFO	testing.py	Starting inference
23 Jun 22 19:34:18	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_12/ckp/last.ckpt
23 Jun 22 19:34:18	INFO	testing.py	normalizing images with: zscore
23 Jun 22 19:34:18	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:34:18	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 19:34:19	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 19:34:19	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 19:34:30	INFO	seed.py	Global seed set to 42
23 Jun 22 19:34:30	INFO	datasets.py	found 12610 train images
23 Jun 22 19:34:30	INFO	datasets.py	found 1425 val images
23 Jun 22 19:34:30	INFO	datasets.py	found 200 test images
23 Jun 22 19:34:30	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 19:34:30	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:34:30	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 19:34:31	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 19:34:31	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 19:34:31	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 19:34:31	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:34:31	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 19:34:31	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 19:34:31	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 19:34:31	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 19:34:31	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:34:31	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 19:34:31	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 19:34:31	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 19:34:31	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 19:34:31	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 19:34:31	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 19:34:31	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 19:34:31	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 19:34:31	INFO	cli.py	Output directory set to output/debug/version_13
23 Jun 22 19:34:31	INFO	log.py	Logs saved to run.log
23 Jun 22 19:34:31	INFO	log.py	Core count             = 12
23 Jun 22 19:34:31	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 19:34:31	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 19:34:31	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 19:34:31	INFO	log.py	CUDA version           = 11.3
23 Jun 22 19:34:31	INFO	log.py	CUDA count             = 1
23 Jun 22 19:34:31	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 19:34:41	INFO	train_model.py	========== start training ==========
23 Jun 22 19:34:43	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 19:34:43	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 19:34:43	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 0      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 19:44:52	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 4239.961
23 Jun 22 19:44:52	INFO	model_checkpoint.py	Epoch 0, global step 788: 'Step-wise/val_mad' reached 4239.96094 (best 4239.96094), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_13/ckp/best_model.ckpt' as top 1
23 Jun 22 19:49:55	INFO	cli.py	===== Training finished ======
23 Jun 22 19:49:55	INFO	cli.py	Training time : 15.24min for 1190 steps of training
23 Jun 22 19:49:55	INFO	cli.py	Training speed: 1.30 steps/second
23 Jun 22 19:49:55	INFO	train_model.py	========== Testing model ==========
23 Jun 22 19:49:55	INFO	cli.py	Using last obtained model
23 Jun 22 19:49:55	INFO	testing.py	====== Testing model =====
23 Jun 22 19:49:55	INFO	testing.py	Starting inference
23 Jun 22 19:49:56	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_13/ckp/last.ckpt
23 Jun 22 19:49:56	INFO	testing.py	normalizing images with: zscore
23 Jun 22 19:49:56	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:49:56	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 19:49:56	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 19:49:56	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 19:50:04	INFO	seed.py	Global seed set to 42
23 Jun 22 19:50:04	INFO	datasets.py	found 12610 train images
23 Jun 22 19:50:04	INFO	datasets.py	found 1425 val images
23 Jun 22 19:50:04	INFO	datasets.py	found 200 test images
23 Jun 22 19:50:04	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 19:50:04	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:50:05	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 19:50:07	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 19:50:07	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 19:50:07	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 19:50:07	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:50:07	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 19:50:07	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 19:50:07	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 19:50:07	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 19:50:07	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 19:50:07	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 19:50:08	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 19:50:08	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 19:50:08	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 19:50:08	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 19:50:08	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 19:50:08	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 19:50:08	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 19:50:08	INFO	cli.py	Output directory set to output/debug/version_14
23 Jun 22 19:50:08	INFO	log.py	Logs saved to run.log
23 Jun 22 19:50:08	INFO	log.py	Core count             = 12
23 Jun 22 19:50:08	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 19:50:08	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 19:50:08	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 19:50:08	INFO	log.py	CUDA version           = 11.3
23 Jun 22 19:50:08	INFO	log.py	CUDA count             = 1
23 Jun 22 19:50:08	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 19:50:18	INFO	train_model.py	========== start training ==========
23 Jun 22 19:50:22	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 19:50:22	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 19:50:22	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 0      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 22:04:52	INFO	seed.py	Global seed set to 42
23 Jun 22 22:04:52	INFO	datasets.py	found 12610 train images
23 Jun 22 22:04:52	INFO	datasets.py	found 1425 val images
23 Jun 22 22:04:52	INFO	datasets.py	found 200 test images
23 Jun 22 22:04:52	INFO	datasets.py	========== Setting up train data ==========
23 Jun 22 22:04:52	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 22:04:54	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 22:04:55	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 22:04:55	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 22:04:55	INFO	datasets.py	========== Setting up validation data ==========
23 Jun 22 22:04:55	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 22:04:56	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 22:04:56	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 22:04:56	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 22:04:56	INFO	datasets.py	========== Setting up test data ==========
23 Jun 22 22:04:56	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 22:04:56	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 22:04:56	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 22:04:56	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 22:04:56	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
23 Jun 22 22:04:56	INFO	trainer.py	GPU available: True, used: True
23 Jun 22 22:04:56	INFO	trainer.py	TPU available: False, using: 0 TPU cores
23 Jun 22 22:04:56	INFO	trainer.py	IPU available: False, using: 0 IPUs
23 Jun 22 22:04:56	INFO	trainer.py	HPU available: False, using: 0 HPUs
23 Jun 22 22:04:56	INFO	cli.py	Output directory set to output/debug/version_15
23 Jun 22 22:04:56	INFO	log.py	Logs saved to run.log
23 Jun 22 22:04:56	INFO	log.py	Core count             = 12
23 Jun 22 22:04:56	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
23 Jun 22 22:04:56	INFO	log.py	Pytorch version        = 1.10.2+cu113
23 Jun 22 22:04:56	INFO	log.py	Albumentations version = 1.1.0
23 Jun 22 22:04:56	INFO	log.py	CUDA version           = 11.3
23 Jun 22 22:04:56	INFO	log.py	CUDA count             = 1
23 Jun 22 22:04:56	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
23 Jun 22 22:05:05	INFO	train_model.py	========== start training ==========
23 Jun 22 22:05:08	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
23 Jun 22 22:05:08	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 22:05:48	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 0      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
23 Jun 22 22:16:03	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 4537.628
23 Jun 22 22:16:03	INFO	model_checkpoint.py	Epoch 0, global step 788: 'Step-wise/val_mad' reached 4537.62842 (best 4537.62842), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_15/ckp/best_model.ckpt' as top 1
23 Jun 22 22:28:27	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 4503.910 >= min_delta = 0.0. New best score: 33.718
23 Jun 22 22:28:27	INFO	model_checkpoint.py	Epoch 1, global step 1576: 'Step-wise/val_mad' reached 33.71828 (best 33.71828), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_15/ckp/best_model.ckpt' as top 1
23 Jun 22 22:38:42	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 3.596 >= min_delta = 0.0. New best score: 30.122
23 Jun 22 22:38:42	INFO	model_checkpoint.py	Epoch 2, global step 2364: 'Step-wise/val_mad' reached 30.12213 (best 30.12213), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_15/ckp/best_model.ckpt' as top 1
23 Jun 22 22:48:57	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 2.251 >= min_delta = 0.0. New best score: 27.871
23 Jun 22 22:48:57	INFO	model_checkpoint.py	Epoch 3, global step 3152: 'Step-wise/val_mad' reached 27.87126 (best 27.87126), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_15/ckp/best_model.ckpt' as top 1
23 Jun 22 22:59:11	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 12.745 >= min_delta = 0.0. New best score: 15.126
23 Jun 22 22:59:11	INFO	model_checkpoint.py	Epoch 4, global step 3940: 'Step-wise/val_mad' reached 15.12638 (best 15.12638), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_15/ckp/best_model.ckpt' as top 1
23 Jun 22 22:59:14	INFO	cli.py	===== Training finished ======
23 Jun 22 22:59:14	INFO	cli.py	Training time : 54.14min for 3940 steps of training
23 Jun 22 22:59:14	INFO	cli.py	Training speed: 1.21 steps/second
23 Jun 22 22:59:14	INFO	train_model.py	========== Testing model ==========
23 Jun 22 22:59:14	INFO	cli.py	Using last obtained model
23 Jun 22 22:59:14	INFO	testing.py	====== Testing model =====
23 Jun 22 22:59:14	INFO	testing.py	Starting inference
23 Jun 22 22:59:14	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_15/ckp/last.ckpt
23 Jun 22 22:59:14	INFO	testing.py	normalizing images with: zscore
23 Jun 22 22:59:14	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 22:59:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 22:59:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 22:59:15	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 22:59:33	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 22:59:33	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 22:59:33	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 22:59:33	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 22:59:51	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 22:59:51	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 22:59:51	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 22:59:51	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 23:00:09	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:00:09	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 23:00:09	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 23:00:09	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 23:00:27	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:00:27	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 23:00:28	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 23:00:28	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 23:00:43	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:00:43	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 23:00:43	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 23:00:43	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 23:00:59	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:00:59	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 23:00:59	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 23:00:59	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 23:01:17	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:01:17	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 23:01:17	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 23:01:17	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 23:01:35	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:01:35	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 23:01:36	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 23:01:36	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 23:01:53	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:01:54	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
23 Jun 22 23:01:54	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
23 Jun 22 23:01:54	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
23 Jun 22 23:02:12	INFO	testing.py	normalizing images with: zscore
23 Jun 22 23:02:12	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:02:12	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 23:02:12	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 23:02:12	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 23:02:17	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:02:17	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 23:02:17	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 23:02:17	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 23:02:21	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:02:21	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 23:02:21	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 23:02:21	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 23:02:26	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:02:26	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 23:02:26	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 23:02:26	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 23:02:31	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:02:31	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 23:02:31	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 23:02:31	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 23:02:35	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:02:35	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 23:02:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 23:02:35	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 23:02:39	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:02:39	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 23:02:39	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 23:02:39	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 23:02:44	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:02:44	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 23:02:44	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 23:02:44	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 23:02:49	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:02:49	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 23:02:49	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 23:02:49	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 23:02:53	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:02:53	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
23 Jun 22 23:02:53	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
23 Jun 22 23:02:53	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
23 Jun 22 23:02:58	INFO	testing.py	normalizing images with: zscore
23 Jun 22 23:02:58	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
23 Jun 22 23:03:00	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
23 Jun 22 23:03:01	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
23 Jun 22 23:03:01	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
23 Jun 22 23:04:48	INFO	testing.py	train mad (without TTA and regression): 127.52788682686969
23 Jun 22 23:04:48	INFO	testing.py	validation mad (without TTA and regression): 127.31471802529866
23 Jun 22 23:04:48	INFO	testing.py	test mad (without TTA and regression): 132.24763671875
23 Jun 22 23:04:48	INFO	testing.py	===== regress correct on raw images =====
23 Jun 22 23:04:48	INFO	testing.py	Linear bias prediction:	slope: -48.6052	intercept: -137.3662	r = -0.9332	p-value = 0.0E+00	std error = 1.7E-01
23 Jun 22 23:04:48	INFO	testing.py	train mad (after regression): 10.964395471488618
23 Jun 22 23:04:48	INFO	testing.py	validation mad (after regression): 11.356925015372452
23 Jun 22 23:04:48	INFO	testing.py	test mad (after regression): 11.327454833984374
23 Jun 22 23:04:48	INFO	testing.py	===== regress correct on raw images and TTA =====
23 Jun 22 23:04:48	INFO	testing.py	Linear bias prediction:	slope: -48.6052	intercept: -137.3662	r = -0.9332	p-value = 0.0E+00	std error = 1.7E-01
23 Jun 22 23:04:48	INFO	testing.py	train mad (after regression and TTA): 10.964395510707764
23 Jun 22 23:04:48	INFO	testing.py	validation mad (after regression and TTA): 11.21307934564237
23 Jun 22 23:04:48	INFO	testing.py	test mad (after regression and TTA): 11.106542525265189
23 Jun 22 23:04:48	INFO	testing.py	saving outputs to output/debug/version_15/predictions
23 Jun 22 23:04:50	INFO	train_model.py	======= END =========
24 Jun 22 09:18:01	INFO	seed.py	Global seed set to 42
24 Jun 22 09:18:01	INFO	datasets.py	found 12610 train images
24 Jun 22 09:18:01	INFO	datasets.py	found 1425 val images
24 Jun 22 09:18:01	INFO	datasets.py	found 200 test images
24 Jun 22 09:18:01	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 09:18:01	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:18:02	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 09:18:04	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 09:18:04	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 09:18:04	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 09:18:04	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:18:04	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 09:18:04	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 09:18:04	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 09:18:04	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 09:18:04	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:18:04	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 09:18:04	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 09:18:04	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 09:18:05	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 09:18:05	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 09:18:05	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 09:18:05	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 09:18:05	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 09:18:05	INFO	cli.py	Output directory set to output/debug/version_16
24 Jun 22 09:18:05	INFO	log.py	Logs saved to run.log
24 Jun 22 09:18:05	INFO	log.py	Core count             = 12
24 Jun 22 09:18:05	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 09:18:05	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 09:18:05	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 09:18:05	INFO	log.py	CUDA version           = 11.3
24 Jun 22 09:18:05	INFO	log.py	CUDA count             = 1
24 Jun 22 09:18:05	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 09:18:13	INFO	train_model.py	========== start training ==========
24 Jun 22 09:18:17	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 09:18:17	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 2      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:18:17	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:22:15	INFO	seed.py	Global seed set to 42
24 Jun 22 09:22:15	INFO	datasets.py	found 12610 train images
24 Jun 22 09:22:15	INFO	datasets.py	found 1425 val images
24 Jun 22 09:22:15	INFO	datasets.py	found 200 test images
24 Jun 22 09:22:15	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 09:22:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:22:17	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 09:22:18	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 09:22:18	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 09:22:18	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 09:22:18	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:22:18	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 09:22:19	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 09:22:19	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 09:22:19	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 09:22:19	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:22:19	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 09:22:19	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 09:22:19	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 09:22:19	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 09:22:19	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 09:22:19	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 09:22:19	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 09:22:19	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 09:22:19	INFO	cli.py	Output directory set to output/debug/version_17
24 Jun 22 09:22:19	INFO	log.py	Logs saved to run.log
24 Jun 22 09:22:19	INFO	log.py	Core count             = 12
24 Jun 22 09:22:19	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 09:22:19	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 09:22:19	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 09:22:19	INFO	log.py	CUDA version           = 11.3
24 Jun 22 09:22:19	INFO	log.py	CUDA count             = 1
24 Jun 22 09:22:19	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 09:22:26	INFO	train_model.py	========== start training ==========
24 Jun 22 09:23:10	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 09:23:10	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 2      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:23:10	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:27:53	INFO	cli.py	===== Training finished ======
24 Jun 22 09:27:53	INFO	cli.py	Training time : 4.75min for 0 steps of training
24 Jun 22 09:27:53	INFO	cli.py	Training speed: 0.00 steps/second
24 Jun 22 09:27:53	INFO	train_model.py	========== Testing model ==========
24 Jun 22 09:27:53	INFO	cli.py	Using last obtained model
24 Jun 22 09:27:53	INFO	testing.py	====== Testing model =====
24 Jun 22 09:27:53	INFO	testing.py	Starting inference
24 Jun 22 09:27:59	INFO	seed.py	Global seed set to 42
24 Jun 22 09:27:59	INFO	datasets.py	found 12610 train images
24 Jun 22 09:27:59	INFO	datasets.py	found 1425 val images
24 Jun 22 09:27:59	INFO	datasets.py	found 200 test images
24 Jun 22 09:27:59	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 09:27:59	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:28:00	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 09:28:02	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 09:28:02	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 09:28:02	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 09:28:02	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:28:02	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 09:28:02	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 09:28:02	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 09:28:02	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 09:28:02	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:28:02	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 09:28:02	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 09:28:02	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 09:28:03	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 09:28:03	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 09:28:03	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 09:28:03	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 09:28:03	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 09:28:03	INFO	cli.py	Output directory set to output/debug/version_18
24 Jun 22 09:28:03	INFO	log.py	Logs saved to run.log
24 Jun 22 09:28:03	INFO	log.py	Core count             = 12
24 Jun 22 09:28:03	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 09:28:03	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 09:28:03	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 09:28:03	INFO	log.py	CUDA version           = 11.3
24 Jun 22 09:28:03	INFO	log.py	CUDA count             = 1
24 Jun 22 09:28:03	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 09:28:13	INFO	train_model.py	========== start training ==========
24 Jun 22 09:28:16	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 09:28:16	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 2      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:28:16	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:29:17	INFO	seed.py	Global seed set to 42
24 Jun 22 09:29:17	INFO	datasets.py	found 12610 train images
24 Jun 22 09:29:17	INFO	datasets.py	found 1425 val images
24 Jun 22 09:29:17	INFO	datasets.py	found 200 test images
24 Jun 22 09:29:17	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 09:29:17	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:29:19	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 09:29:21	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 09:29:21	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 09:29:21	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 09:29:21	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:29:21	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 09:29:21	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 09:29:21	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 09:29:21	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 09:29:21	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:29:21	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 09:29:21	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 09:29:21	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 09:29:21	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 09:29:21	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 09:29:21	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 09:29:21	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 09:29:21	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 09:29:21	INFO	cli.py	Output directory set to output/debug/version_19
24 Jun 22 09:29:21	INFO	log.py	Logs saved to run.log
24 Jun 22 09:29:21	INFO	log.py	Core count             = 12
24 Jun 22 09:29:21	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 09:29:21	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 09:29:21	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 09:29:21	INFO	log.py	CUDA version           = 11.3
24 Jun 22 09:29:21	INFO	log.py	CUDA count             = 1
24 Jun 22 09:29:21	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 09:29:32	INFO	train_model.py	========== start training ==========
24 Jun 22 09:29:34	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 09:29:34	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 2      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:29:34	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:32:31	INFO	seed.py	Global seed set to 42
24 Jun 22 09:32:31	INFO	datasets.py	found 12610 train images
24 Jun 22 09:32:31	INFO	datasets.py	found 1425 val images
24 Jun 22 09:32:31	INFO	datasets.py	found 200 test images
24 Jun 22 09:32:31	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 09:32:31	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:32:33	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 09:32:34	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 09:32:34	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 09:32:34	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 09:32:34	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:32:35	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 09:32:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 09:32:35	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 09:32:35	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 09:32:35	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:32:35	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 09:32:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 09:32:35	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 09:32:35	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 09:32:35	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 09:32:35	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 09:32:35	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 09:32:35	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 09:32:35	INFO	cli.py	Output directory set to output/debug/version_20
24 Jun 22 09:32:35	INFO	log.py	Logs saved to run.log
24 Jun 22 09:32:35	INFO	log.py	Core count             = 12
24 Jun 22 09:32:35	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 09:32:35	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 09:32:35	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 09:32:35	INFO	log.py	CUDA version           = 11.3
24 Jun 22 09:32:35	INFO	log.py	CUDA count             = 1
24 Jun 22 09:32:35	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 09:32:46	INFO	train_model.py	========== start training ==========
24 Jun 22 09:32:48	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 09:32:48	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 2      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:32:48	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:36:35	INFO	seed.py	Global seed set to 42
24 Jun 22 09:36:35	INFO	datasets.py	found 12610 train images
24 Jun 22 09:36:35	INFO	datasets.py	found 1425 val images
24 Jun 22 09:36:35	INFO	datasets.py	found 200 test images
24 Jun 22 09:36:35	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 09:36:35	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:36:36	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 09:36:38	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 09:36:38	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 09:36:38	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 09:36:38	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:36:38	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 09:36:38	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 09:36:38	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 09:36:38	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 09:36:38	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:36:38	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 09:36:38	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 09:36:38	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 09:36:39	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 09:36:39	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 09:36:39	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 09:36:39	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 09:36:39	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 09:36:39	INFO	cli.py	Output directory set to output/debug/version_21
24 Jun 22 09:36:39	INFO	log.py	Logs saved to run.log
24 Jun 22 09:36:39	INFO	log.py	Core count             = 12
24 Jun 22 09:36:39	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 09:36:39	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 09:36:39	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 09:36:39	INFO	log.py	CUDA version           = 11.3
24 Jun 22 09:36:39	INFO	log.py	CUDA count             = 1
24 Jun 22 09:36:39	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 09:36:48	INFO	train_model.py	========== start training ==========
24 Jun 22 09:36:51	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 09:36:51	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 2      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:37:31	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:42:39	INFO	seed.py	Global seed set to 42
24 Jun 22 09:42:39	INFO	datasets.py	found 12610 train images
24 Jun 22 09:42:39	INFO	datasets.py	found 1425 val images
24 Jun 22 09:42:39	INFO	datasets.py	found 200 test images
24 Jun 22 09:42:39	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 09:42:39	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:42:40	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 09:42:42	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 09:42:42	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 09:42:42	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 09:42:42	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:42:42	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 09:42:42	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 09:42:42	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 09:42:42	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 09:42:42	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:42:42	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 09:42:42	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 09:42:42	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 09:42:43	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 09:42:43	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 09:42:43	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 09:42:43	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 09:42:43	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 09:42:43	INFO	cli.py	Output directory set to output/debug/version_22
24 Jun 22 09:42:43	INFO	log.py	Logs saved to run.log
24 Jun 22 09:42:43	INFO	log.py	Core count             = 12
24 Jun 22 09:42:43	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 09:42:43	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 09:42:43	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 09:42:43	INFO	log.py	CUDA version           = 11.3
24 Jun 22 09:42:43	INFO	log.py	CUDA count             = 1
24 Jun 22 09:42:43	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 09:42:53	INFO	train_model.py	========== start training ==========
24 Jun 22 09:42:56	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 09:42:56	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 2      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:42:56	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:47:20	INFO	seed.py	Global seed set to 42
24 Jun 22 09:47:20	INFO	datasets.py	found 12610 train images
24 Jun 22 09:47:20	INFO	datasets.py	found 1425 val images
24 Jun 22 09:47:20	INFO	datasets.py	found 200 test images
24 Jun 22 09:47:20	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 09:47:20	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:47:22	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 09:47:23	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 09:47:23	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 09:47:23	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 09:47:23	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:47:24	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 09:47:24	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 09:47:24	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 09:47:24	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 09:47:24	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:47:24	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 09:47:24	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 09:47:24	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 09:47:24	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 09:47:24	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 09:47:24	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 09:47:24	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 09:47:24	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 09:47:24	INFO	cli.py	Output directory set to output/debug/version_23
24 Jun 22 09:47:24	INFO	log.py	Logs saved to run.log
24 Jun 22 09:47:24	INFO	log.py	Core count             = 12
24 Jun 22 09:47:24	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 09:47:24	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 09:47:24	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 09:47:24	INFO	log.py	CUDA version           = 11.3
24 Jun 22 09:47:24	INFO	log.py	CUDA count             = 1
24 Jun 22 09:47:24	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 09:47:35	INFO	train_model.py	========== start training ==========
24 Jun 22 09:47:37	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 09:47:37	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 2      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:47:37	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:48:24	INFO	seed.py	Global seed set to 42
24 Jun 22 09:48:24	INFO	datasets.py	found 12610 train images
24 Jun 22 09:48:24	INFO	datasets.py	found 1425 val images
24 Jun 22 09:48:24	INFO	datasets.py	found 200 test images
24 Jun 22 09:48:24	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 09:48:24	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:48:25	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 09:48:27	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 09:48:27	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 09:48:27	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 09:48:27	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:48:27	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 09:48:28	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 09:48:28	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 09:48:28	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 09:48:28	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:48:28	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 09:48:28	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 09:48:28	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 09:48:28	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 09:48:28	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 09:48:28	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 09:48:28	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 09:48:28	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 09:48:28	INFO	cli.py	Output directory set to output/debug/version_24
24 Jun 22 09:48:28	INFO	log.py	Logs saved to run.log
24 Jun 22 09:48:28	INFO	log.py	Core count             = 12
24 Jun 22 09:48:28	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 09:48:28	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 09:48:28	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 09:48:28	INFO	log.py	CUDA version           = 11.3
24 Jun 22 09:48:28	INFO	log.py	CUDA count             = 1
24 Jun 22 09:48:28	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 09:48:39	INFO	train_model.py	========== start training ==========
24 Jun 22 09:48:41	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 09:48:41	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 0      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:48:41	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 0      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:50:00	INFO	cli.py	===== Training finished ======
24 Jun 22 09:50:00	INFO	cli.py	Training time : 1.35min for 92 steps of training
24 Jun 22 09:50:00	INFO	cli.py	Training speed: 1.13 steps/second
24 Jun 22 09:50:00	INFO	train_model.py	========== Testing model ==========
24 Jun 22 09:50:00	INFO	cli.py	Using last obtained model
24 Jun 22 09:50:00	INFO	testing.py	====== Testing model =====
24 Jun 22 09:50:00	INFO	testing.py	Starting inference
24 Jun 22 09:50:06	INFO	seed.py	Global seed set to 42
24 Jun 22 09:50:06	INFO	datasets.py	found 12610 train images
24 Jun 22 09:50:06	INFO	datasets.py	found 1425 val images
24 Jun 22 09:50:06	INFO	datasets.py	found 200 test images
24 Jun 22 09:50:06	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 09:50:06	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:50:08	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 09:50:09	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 09:50:09	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 09:50:09	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 09:50:09	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:50:09	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 09:50:10	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 09:50:10	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 09:50:10	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 09:50:10	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:50:10	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 09:50:10	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 09:50:10	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 09:50:10	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 09:50:10	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 09:50:10	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 09:50:10	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 09:50:10	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 09:50:10	INFO	cli.py	Output directory set to output/debug/version_25
24 Jun 22 09:50:10	INFO	log.py	Logs saved to run.log
24 Jun 22 09:50:10	INFO	log.py	Core count             = 12
24 Jun 22 09:50:10	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 09:50:10	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 09:50:10	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 09:50:10	INFO	log.py	CUDA version           = 11.3
24 Jun 22 09:50:10	INFO	log.py	CUDA count             = 1
24 Jun 22 09:50:10	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 09:50:17	INFO	train_model.py	========== start training ==========
24 Jun 22 09:51:01	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 09:51:01	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 2      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:51:01	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:59:21	INFO	seed.py	Global seed set to 42
24 Jun 22 09:59:21	INFO	datasets.py	found 12610 train images
24 Jun 22 09:59:21	INFO	datasets.py	found 1425 val images
24 Jun 22 09:59:21	INFO	datasets.py	found 200 test images
24 Jun 22 09:59:21	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 09:59:21	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:59:23	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 09:59:25	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 09:59:25	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 09:59:25	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 09:59:25	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:59:25	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 09:59:25	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 09:59:25	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 09:59:25	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 09:59:25	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 09:59:25	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 09:59:25	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 09:59:25	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 09:59:26	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 09:59:26	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 09:59:26	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 09:59:26	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 09:59:26	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 09:59:26	INFO	cli.py	Output directory set to output/debug/version_26
24 Jun 22 09:59:26	INFO	log.py	Logs saved to run.log
24 Jun 22 09:59:26	INFO	log.py	Core count             = 12
24 Jun 22 09:59:26	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 09:59:26	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 09:59:26	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 09:59:26	INFO	log.py	CUDA version           = 11.3
24 Jun 22 09:59:26	INFO	log.py	CUDA count             = 1
24 Jun 22 09:59:26	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 09:59:36	INFO	train_model.py	========== start training ==========
24 Jun 22 09:59:39	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 09:59:39	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 2      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 09:59:39	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 10:10:00	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 3792.421
24 Jun 22 10:10:00	INFO	model_checkpoint.py	Epoch 0, global step 788: 'Step-wise/val_mad' reached 3792.42065 (best 3792.42065), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_26/ckp/best_model.ckpt' as top 1
24 Jun 22 10:20:16	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 3758.621 >= min_delta = 0.0. New best score: 33.800
24 Jun 22 10:20:16	INFO	model_checkpoint.py	Epoch 1, global step 1576: 'Step-wise/val_mad' reached 33.79982 (best 33.79982), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_26/ckp/best_model.ckpt' as top 1
24 Jun 22 10:30:32	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 0.991 >= min_delta = 0.0. New best score: 32.809
24 Jun 22 10:30:32	INFO	model_checkpoint.py	Epoch 2, global step 2364: 'Step-wise/val_mad' reached 32.80903 (best 32.80903), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_26/ckp/best_model.ckpt' as top 1
24 Jun 22 10:40:51	INFO	model_checkpoint.py	Epoch 3, global step 3152: 'Step-wise/val_mad' was not in top 1
24 Jun 22 10:52:34	INFO	model_checkpoint.py	Epoch 4, global step 3940: 'Step-wise/val_mad' was not in top 1
24 Jun 22 10:52:36	INFO	cli.py	===== Training finished ======
24 Jun 22 10:52:36	INFO	cli.py	Training time : 53.00min for 3940 steps of training
24 Jun 22 10:52:36	INFO	cli.py	Training speed: 1.24 steps/second
24 Jun 22 10:52:36	INFO	train_model.py	========== Testing model ==========
24 Jun 22 10:52:36	INFO	cli.py	Using last obtained model
24 Jun 22 10:52:36	INFO	testing.py	====== Testing model =====
24 Jun 22 10:52:36	INFO	testing.py	Starting inference
24 Jun 22 10:52:37	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_26/ckp/last.ckpt
24 Jun 22 10:52:37	INFO	testing.py	normalizing images with: zscore
24 Jun 22 10:52:37	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:52:37	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 10:52:37	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 10:52:37	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 10:52:55	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:52:56	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 10:52:56	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 10:52:56	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 10:53:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:53:16	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 10:53:16	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 10:53:16	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 10:53:34	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:53:35	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 10:53:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 10:53:35	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 10:53:53	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:53:53	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 10:53:54	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 10:53:54	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 10:54:09	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:54:09	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 10:54:09	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 10:54:09	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 10:54:25	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:54:25	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 10:54:26	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 10:54:26	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 10:54:44	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:54:44	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 10:54:44	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 10:54:44	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 10:55:04	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:55:04	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 10:55:05	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 10:55:05	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 10:55:23	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:55:23	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 10:55:23	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 10:55:23	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 10:55:42	INFO	testing.py	normalizing images with: zscore
24 Jun 22 10:55:42	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:55:42	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 10:55:42	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 10:55:42	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 10:55:47	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:55:47	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 10:55:47	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 10:55:47	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 10:55:51	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:55:51	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 10:55:52	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 10:55:52	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 10:55:56	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:55:56	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 10:55:56	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 10:55:56	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 10:56:01	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:56:01	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 10:56:01	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 10:56:01	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 10:56:06	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:56:06	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 10:56:06	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 10:56:06	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 10:56:10	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:56:10	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 10:56:10	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 10:56:10	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 10:56:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:56:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 10:56:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 10:56:15	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 10:56:20	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:56:20	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 10:56:20	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 10:56:20	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 10:56:25	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:56:25	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 10:56:25	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 10:56:25	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 10:56:29	INFO	testing.py	normalizing images with: zscore
24 Jun 22 10:56:29	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 10:56:31	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 10:56:33	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 10:56:33	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 10:58:26	INFO	testing.py	train mad (without TTA and regression): 127.44959949242605
24 Jun 22 10:58:26	INFO	testing.py	validation mad (without TTA and regression): 127.21525825720309
24 Jun 22 10:58:26	INFO	testing.py	test mad (without TTA and regression): 132.198447265625
24 Jun 22 10:58:26	INFO	testing.py	===== regress correct on raw images =====
24 Jun 22 10:58:26	INFO	testing.py	Linear bias prediction:	slope: -31.9746	intercept: -131.4184	r = -0.2138	p-value = 2.4E-130	std error = 1.3E+00
24 Jun 22 10:58:26	INFO	testing.py	train mad (after regression): 32.23942223808391
24 Jun 22 10:58:26	INFO	testing.py	validation mad (after regression): 32.62929879655657
24 Jun 22 10:58:26	INFO	testing.py	test mad (after regression): 34.2334716796875
24 Jun 22 10:58:26	INFO	testing.py	===== regress correct on raw images and TTA =====
24 Jun 22 10:58:26	INFO	testing.py	Linear bias prediction:	slope: -31.9746	intercept: -131.4184	r = -0.2138	p-value = 2.4E-130	std error = 1.3E+00
24 Jun 22 10:58:26	INFO	testing.py	train mad (after regression and TTA): 32.2394213649349
24 Jun 22 10:58:26	INFO	testing.py	validation mad (after regression and TTA): 32.64947355261773
24 Jun 22 10:58:26	INFO	testing.py	test mad (after regression and TTA): 34.25155303675632
24 Jun 22 10:58:26	INFO	testing.py	saving outputs to output/debug/version_26/predictions
24 Jun 22 10:58:28	INFO	train_model.py	======= END =========
24 Jun 22 11:00:47	INFO	seed.py	Global seed set to 42
24 Jun 22 11:00:47	INFO	datasets.py	found 12610 train images
24 Jun 22 11:00:47	INFO	datasets.py	found 1425 val images
24 Jun 22 11:00:47	INFO	datasets.py	found 200 test images
24 Jun 22 11:00:47	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 11:00:47	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:00:49	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 11:00:50	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 11:00:50	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 11:00:50	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 11:00:50	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:00:50	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 11:00:51	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 11:00:51	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 11:00:51	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 11:00:51	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:00:51	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 11:00:51	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 11:00:51	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 11:00:51	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 11:00:51	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 11:00:51	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 11:00:51	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 11:00:51	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 11:00:51	INFO	cli.py	Output directory set to output/debug/version_27
24 Jun 22 11:00:51	INFO	log.py	Logs saved to run.log
24 Jun 22 11:00:51	INFO	log.py	Core count             = 12
24 Jun 22 11:00:51	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 11:00:51	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 11:00:51	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 11:00:51	INFO	log.py	CUDA version           = 11.3
24 Jun 22 11:00:51	INFO	log.py	CUDA count             = 1
24 Jun 22 11:00:51	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 11:02:08	INFO	seed.py	Global seed set to 42
24 Jun 22 11:02:08	INFO	datasets.py	found 12610 train images
24 Jun 22 11:02:08	INFO	datasets.py	found 1425 val images
24 Jun 22 11:02:08	INFO	datasets.py	found 200 test images
24 Jun 22 11:02:08	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 11:02:08	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:02:10	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 11:02:12	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 11:02:12	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 11:02:12	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 11:02:12	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:02:12	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 11:02:12	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 11:02:12	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 11:02:12	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 11:02:12	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:02:12	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 11:02:12	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 11:02:12	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 11:02:12	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 11:02:12	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 11:02:12	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 11:02:12	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 11:02:12	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 11:02:12	INFO	cli.py	Output directory set to output/debug/version_28
24 Jun 22 11:02:12	INFO	log.py	Logs saved to run.log
24 Jun 22 11:02:12	INFO	log.py	Core count             = 12
24 Jun 22 11:02:12	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 11:02:12	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 11:02:12	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 11:02:12	INFO	log.py	CUDA version           = 11.3
24 Jun 22 11:02:12	INFO	log.py	CUDA count             = 1
24 Jun 22 11:02:12	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 11:07:12	INFO	seed.py	Global seed set to 42
24 Jun 22 11:07:12	INFO	datasets.py	found 12610 train images
24 Jun 22 11:07:12	INFO	datasets.py	found 1425 val images
24 Jun 22 11:07:12	INFO	datasets.py	found 200 test images
24 Jun 22 11:07:12	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 11:07:12	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:07:13	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 11:07:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 11:07:15	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 11:07:15	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 11:07:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:07:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 11:07:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 11:07:15	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 11:07:15	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 11:07:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:07:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 11:07:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 11:07:15	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 11:07:16	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 11:07:16	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 11:07:16	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 11:07:16	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 11:07:16	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 11:07:16	INFO	cli.py	Output directory set to output/debug/version_29
24 Jun 22 11:07:16	INFO	log.py	Logs saved to run.log
24 Jun 22 11:07:16	INFO	log.py	Core count             = 12
24 Jun 22 11:07:16	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 11:07:16	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 11:07:16	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 11:07:16	INFO	log.py	CUDA version           = 11.3
24 Jun 22 11:07:16	INFO	log.py	CUDA count             = 1
24 Jun 22 11:07:16	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 11:09:27	INFO	train_model.py	========== start training ==========
24 Jun 22 11:10:14	INFO	seed.py	Global seed set to 42
24 Jun 22 11:10:14	INFO	datasets.py	found 12610 train images
24 Jun 22 11:10:14	INFO	datasets.py	found 1425 val images
24 Jun 22 11:10:14	INFO	datasets.py	found 200 test images
24 Jun 22 11:10:14	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 11:10:14	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:10:16	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 11:10:18	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 11:10:18	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 11:10:18	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 11:10:18	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:10:18	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 11:10:18	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 11:10:18	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 11:10:18	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 11:10:18	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:10:18	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 11:10:18	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 11:10:18	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 11:10:18	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 11:10:18	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 11:10:18	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 11:10:18	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 11:10:18	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 11:10:18	INFO	cli.py	Output directory set to output/debug/version_30
24 Jun 22 11:10:18	INFO	log.py	Logs saved to run.log
24 Jun 22 11:10:18	INFO	log.py	Core count             = 12
24 Jun 22 11:10:18	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 11:10:18	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 11:10:18	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 11:10:18	INFO	log.py	CUDA version           = 11.3
24 Jun 22 11:10:18	INFO	log.py	CUDA count             = 1
24 Jun 22 11:10:18	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 11:10:30	INFO	train_model.py	========== start training ==========
24 Jun 22 11:10:32	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 11:10:33	INFO	model_summary.py	
  | Name     | Type                 | Params | In sizes            | Out sizes       
-------------------------------------------------------------------------------------------
0 | backbone | EfficientnetBackbone | 5.3 M  | ?                   | ?               
1 | dense    | DenseNetwork         | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]]
2 | loss     | MultiTaskLoss        | 2      | ?                   | ?               
-------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 11:10:33	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 5.3 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 5.3 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._fc          | Linear                  | 1.3 M  | ?                   | ?                
10 | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
11 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
12 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
13 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
14 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
15 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
16 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
17 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
18 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
19 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
20 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
21 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
23 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
24 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
25 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
8.5 M     Trainable params
0         Non-trainable params
8.5 M     Total params
16.941    Total estimated model params size (MB)
24 Jun 22 11:15:19	INFO	cli.py	===== Training finished ======
24 Jun 22 11:15:19	INFO	cli.py	Training time : 4.81min for 0 steps of training
24 Jun 22 11:15:19	INFO	cli.py	Training speed: 0.00 steps/second
24 Jun 22 11:15:19	INFO	train_model.py	========== Testing model ==========
24 Jun 22 11:15:19	INFO	cli.py	Using best model
24 Jun 22 11:15:19	INFO	testing.py	====== Testing model =====
24 Jun 22 11:15:19	INFO	testing.py	Starting inference
24 Jun 22 11:15:25	INFO	seed.py	Global seed set to 42
24 Jun 22 11:15:25	INFO	datasets.py	found 12610 train images
24 Jun 22 11:15:25	INFO	datasets.py	found 1425 val images
24 Jun 22 11:15:25	INFO	datasets.py	found 200 test images
24 Jun 22 11:15:25	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 11:15:25	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:15:26	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 11:15:28	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 11:15:28	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 11:15:28	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 11:15:28	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:15:28	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 11:15:29	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 11:15:29	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 11:15:29	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 11:15:29	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:15:29	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 11:15:29	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 11:15:29	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 11:17:31	INFO	seed.py	Global seed set to 42
24 Jun 22 11:17:31	INFO	datasets.py	found 12610 train images
24 Jun 22 11:17:31	INFO	datasets.py	found 1425 val images
24 Jun 22 11:17:31	INFO	datasets.py	found 200 test images
24 Jun 22 11:17:31	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 11:17:31	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:17:33	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 11:17:34	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 11:17:34	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 11:17:34	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 11:17:34	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:17:35	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 11:17:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 11:17:35	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 11:17:35	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 11:17:35	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:17:35	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 11:17:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 11:17:35	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 11:17:35	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 11:17:35	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 11:17:35	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 11:17:35	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 11:17:35	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 11:17:35	INFO	cli.py	Output directory set to output/debug/version_31
24 Jun 22 11:20:26	INFO	seed.py	Global seed set to 42
24 Jun 22 11:20:26	INFO	datasets.py	found 12610 train images
24 Jun 22 11:20:26	INFO	datasets.py	found 1425 val images
24 Jun 22 11:20:26	INFO	datasets.py	found 200 test images
24 Jun 22 11:20:26	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 11:20:26	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:20:27	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 11:20:29	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 11:20:29	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 11:20:29	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 11:20:29	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:20:29	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 11:20:29	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 11:20:29	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 11:20:29	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 11:20:29	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:20:29	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 11:20:29	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 11:20:29	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 11:20:30	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 11:20:45	INFO	seed.py	Global seed set to 42
24 Jun 22 11:20:46	INFO	datasets.py	found 12610 train images
24 Jun 22 11:20:46	INFO	datasets.py	found 1425 val images
24 Jun 22 11:20:46	INFO	datasets.py	found 200 test images
24 Jun 22 11:20:46	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 11:20:46	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:20:47	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 11:20:49	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 11:20:49	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 11:20:49	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 11:20:49	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:20:49	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 11:20:49	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 11:20:49	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 11:20:49	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 11:20:49	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:20:49	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 11:20:49	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 11:20:49	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 11:20:50	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 11:20:50	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 11:20:50	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 11:20:50	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 11:20:50	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 11:20:50	INFO	cli.py	Output directory set to output/debug/version_31
24 Jun 22 11:25:25	INFO	seed.py	Global seed set to 42
24 Jun 22 11:25:25	INFO	datasets.py	found 12610 train images
24 Jun 22 11:25:25	INFO	datasets.py	found 1425 val images
24 Jun 22 11:25:25	INFO	datasets.py	found 200 test images
24 Jun 22 11:25:25	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 11:25:25	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:25:26	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 11:25:28	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 11:25:28	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 11:25:28	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 11:25:28	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:25:28	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 11:25:28	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 11:25:28	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 11:25:28	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 11:25:28	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:25:28	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 11:25:28	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 11:25:28	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 11:25:29	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 11:25:29	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 11:25:29	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 11:25:29	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 11:25:29	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 11:25:29	INFO	cli.py	Output directory set to output/debug/version_31
24 Jun 22 11:26:32	INFO	seed.py	Global seed set to 42
24 Jun 22 11:26:32	INFO	datasets.py	found 12610 train images
24 Jun 22 11:26:32	INFO	datasets.py	found 1425 val images
24 Jun 22 11:26:32	INFO	datasets.py	found 200 test images
24 Jun 22 11:26:32	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 11:26:32	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:26:33	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 11:26:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 11:26:35	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 11:26:35	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 11:26:35	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:26:35	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 11:26:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 11:26:35	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 11:26:35	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 11:26:35	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:26:35	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 11:26:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 11:26:35	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 11:26:36	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 11:26:36	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 11:26:36	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 11:26:36	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 11:26:36	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 11:26:36	INFO	cli.py	Output directory set to output/debug/version_31
24 Jun 22 11:28:02	INFO	seed.py	Global seed set to 42
24 Jun 22 11:28:02	INFO	datasets.py	found 12610 train images
24 Jun 22 11:28:02	INFO	datasets.py	found 1425 val images
24 Jun 22 11:28:02	INFO	datasets.py	found 200 test images
24 Jun 22 11:28:02	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 11:28:02	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:28:04	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 11:28:05	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 11:28:05	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 11:28:05	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 11:28:05	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:28:05	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 11:28:05	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 11:28:05	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 11:28:05	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 11:28:05	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:28:06	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 11:28:06	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 11:28:06	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 11:28:06	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 11:28:06	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 11:28:06	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 11:28:06	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 11:28:06	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 11:28:06	INFO	cli.py	Output directory set to output/debug/version_31
24 Jun 22 11:29:11	INFO	seed.py	Global seed set to 42
24 Jun 22 11:29:11	INFO	datasets.py	found 12610 train images
24 Jun 22 11:29:11	INFO	datasets.py	found 1425 val images
24 Jun 22 11:29:11	INFO	datasets.py	found 200 test images
24 Jun 22 11:29:11	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 11:29:11	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:29:13	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 11:29:14	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 11:29:14	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 11:29:14	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 11:29:14	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:29:14	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 11:29:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 11:29:15	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 11:29:15	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 11:29:15	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 11:29:15	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 11:29:15	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 11:29:15	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 11:29:15	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 11:29:15	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 11:29:15	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 11:29:15	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 11:29:15	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 11:29:15	INFO	cli.py	Output directory set to output/debug/version_31
24 Jun 22 11:29:15	INFO	log.py	Logs saved to run.log
24 Jun 22 11:29:15	INFO	log.py	Core count             = 12
24 Jun 22 11:29:15	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 11:29:15	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 11:29:15	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 11:29:15	INFO	log.py	CUDA version           = 11.3
24 Jun 22 11:29:15	INFO	log.py	CUDA count             = 1
24 Jun 22 11:29:15	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 11:29:25	INFO	train_model.py	========== start training ==========
24 Jun 22 11:29:27	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 11:30:08	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 4.0 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 4.0 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
10 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
11 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
12 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
13 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
14 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
15 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
16 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
17 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
18 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
19 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
20 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
21 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
23 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
24 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
7.2 M     Trainable params
0         Non-trainable params
7.2 M     Total params
14.379    Total estimated model params size (MB)
24 Jun 22 11:40:24	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 33.973
24 Jun 22 11:40:24	INFO	model_checkpoint.py	Epoch 0, global step 788: 'Step-wise/val_mad' reached 33.97256 (best 33.97256), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_31/ckp/best_model.ckpt' as top 1
24 Jun 22 11:50:31	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 0.062 >= min_delta = 0.0. New best score: 33.911
24 Jun 22 11:50:31	INFO	model_checkpoint.py	Epoch 1, global step 1576: 'Step-wise/val_mad' reached 33.91096 (best 33.91096), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_31/ckp/best_model.ckpt' as top 1
24 Jun 22 12:00:37	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 1.446 >= min_delta = 0.0. New best score: 32.465
24 Jun 22 12:00:37	INFO	model_checkpoint.py	Epoch 2, global step 2364: 'Step-wise/val_mad' reached 32.46543 (best 32.46543), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_31/ckp/best_model.ckpt' as top 1
24 Jun 22 12:10:43	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 0.130 >= min_delta = 0.0. New best score: 32.335
24 Jun 22 12:10:43	INFO	model_checkpoint.py	Epoch 3, global step 3152: 'Step-wise/val_mad' reached 32.33531 (best 32.33531), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_31/ckp/best_model.ckpt' as top 1
24 Jun 22 12:20:50	INFO	model_checkpoint.py	Epoch 4, global step 3940: 'Step-wise/val_mad' was not in top 1
24 Jun 22 12:30:53	INFO	model_checkpoint.py	Epoch 5, global step 4728: 'Step-wise/val_mad' was not in top 1
24 Jun 22 12:40:55	INFO	model_checkpoint.py	Epoch 6, global step 5516: 'Step-wise/val_mad' was not in top 1
24 Jun 22 12:50:58	INFO	model_checkpoint.py	Epoch 7, global step 6304: 'Step-wise/val_mad' was not in top 1
24 Jun 22 13:01:01	INFO	model_checkpoint.py	Epoch 8, global step 7092: 'Step-wise/val_mad' was not in top 1
24 Jun 22 13:11:03	INFO	model_checkpoint.py	Epoch 9, global step 7880: 'Step-wise/val_mad' was not in top 1
24 Jun 22 13:21:07	INFO	model_checkpoint.py	Epoch 10, global step 8668: 'Step-wise/val_mad' was not in top 1
24 Jun 22 13:31:10	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 0.098 >= min_delta = 0.0. New best score: 32.237
24 Jun 22 13:31:10	INFO	model_checkpoint.py	Epoch 11, global step 9456: 'Step-wise/val_mad' reached 32.23736 (best 32.23736), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_31/ckp/best_model.ckpt' as top 1
24 Jun 22 13:41:13	INFO	model_checkpoint.py	Epoch 12, global step 10244: 'Step-wise/val_mad' was not in top 1
24 Jun 22 13:51:16	INFO	model_checkpoint.py	Epoch 13, global step 11032: 'Step-wise/val_mad' was not in top 1
24 Jun 22 14:01:21	INFO	model_checkpoint.py	Epoch 14, global step 11820: 'Step-wise/val_mad' was not in top 1
24 Jun 22 14:11:24	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 4.565 >= min_delta = 0.0. New best score: 27.673
24 Jun 22 14:11:24	INFO	model_checkpoint.py	Epoch 15, global step 12608: 'Step-wise/val_mad' reached 27.67281 (best 27.67281), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_31/ckp/best_model.ckpt' as top 1
24 Jun 22 14:21:27	INFO	model_checkpoint.py	Epoch 16, global step 13396: 'Step-wise/val_mad' was not in top 1
24 Jun 22 14:31:32	INFO	model_checkpoint.py	Epoch 17, global step 14184: 'Step-wise/val_mad' was not in top 1
24 Jun 22 14:41:37	INFO	model_checkpoint.py	Epoch 18, global step 14972: 'Step-wise/val_mad' was not in top 1
24 Jun 22 14:51:42	INFO	model_checkpoint.py	Epoch 19, global step 15760: 'Step-wise/val_mad' was not in top 1
24 Jun 22 15:01:48	INFO	model_checkpoint.py	Epoch 20, global step 16548: 'Step-wise/val_mad' was not in top 1
24 Jun 22 15:11:56	INFO	model_checkpoint.py	Epoch 21, global step 17336: 'Step-wise/val_mad' was not in top 1
24 Jun 22 15:22:05	INFO	model_checkpoint.py	Epoch 22, global step 18124: 'Step-wise/val_mad' was not in top 1
24 Jun 22 15:32:15	INFO	model_checkpoint.py	Epoch 23, global step 18912: 'Step-wise/val_mad' was not in top 1
24 Jun 22 15:42:27	INFO	model_checkpoint.py	Epoch 24, global step 19700: 'Step-wise/val_mad' was not in top 1
24 Jun 22 15:52:44	INFO	model_checkpoint.py	Epoch 25, global step 20488: 'Step-wise/val_mad' was not in top 1
24 Jun 22 16:03:03	INFO	model_checkpoint.py	Epoch 26, global step 21276: 'Step-wise/val_mad' was not in top 1
24 Jun 22 16:13:25	INFO	model_checkpoint.py	Epoch 27, global step 22064: 'Step-wise/val_mad' was not in top 1
24 Jun 22 16:23:50	INFO	model_checkpoint.py	Epoch 28, global step 22852: 'Step-wise/val_mad' was not in top 1
24 Jun 22 16:34:18	INFO	model_checkpoint.py	Epoch 29, global step 23640: 'Step-wise/val_mad' was not in top 1
24 Jun 22 16:44:56	INFO	model_checkpoint.py	Epoch 30, global step 24428: 'Step-wise/val_mad' was not in top 1
24 Jun 22 16:55:36	INFO	model_checkpoint.py	Epoch 31, global step 25216: 'Step-wise/val_mad' was not in top 1
24 Jun 22 17:06:20	INFO	model_checkpoint.py	Epoch 32, global step 26004: 'Step-wise/val_mad' was not in top 1
24 Jun 22 17:17:08	INFO	model_checkpoint.py	Epoch 33, global step 26792: 'Step-wise/val_mad' was not in top 1
24 Jun 22 17:28:01	INFO	model_checkpoint.py	Epoch 34, global step 27580: 'Step-wise/val_mad' was not in top 1
24 Jun 22 17:30:18	INFO	cli.py	===== Training finished ======
24 Jun 22 17:30:18	INFO	cli.py	Training time : 360.88min for 27738 steps of training
24 Jun 22 17:30:18	INFO	cli.py	Training speed: 1.28 steps/second
24 Jun 22 17:30:18	INFO	train_model.py	========== Testing model ==========
24 Jun 22 17:30:18	INFO	cli.py	Using best model
24 Jun 22 17:30:18	INFO	testing.py	====== Testing model =====
24 Jun 22 17:30:18	INFO	testing.py	Starting inference
24 Jun 22 17:30:19	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_31/ckp/best_model.ckpt
24 Jun 22 17:30:19	INFO	testing.py	normalizing images with: zscore
24 Jun 22 17:30:19	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:30:19	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 17:30:19	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 17:30:19	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 17:30:42	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:30:42	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 17:30:42	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 17:30:42	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 17:31:05	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:31:05	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 17:31:05	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 17:31:05	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 17:31:27	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:31:28	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 17:31:28	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 17:31:28	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 17:31:51	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:31:51	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 17:31:51	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 17:31:51	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 17:32:10	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:32:10	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 17:32:10	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 17:32:10	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 17:32:29	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:32:29	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 17:32:29	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 17:32:29	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 17:32:51	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:32:51	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 17:32:51	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 17:32:51	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 17:33:13	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:33:13	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 17:33:13	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 17:33:13	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 17:33:35	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:33:35	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 17:33:35	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 17:33:35	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 17:33:57	INFO	testing.py	normalizing images with: zscore
24 Jun 22 17:33:57	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:33:57	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 17:33:57	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 17:33:57	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 17:34:03	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:34:03	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 17:34:03	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 17:34:03	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 17:34:10	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:34:10	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 17:34:10	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 17:34:10	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 17:34:16	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:34:16	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 17:34:16	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 17:34:16	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 17:34:22	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:34:22	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 17:34:22	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 17:34:22	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 17:34:28	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:34:28	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 17:34:28	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 17:34:28	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 17:34:33	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:34:33	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 17:34:33	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 17:34:33	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 17:34:40	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:34:40	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 17:34:40	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 17:34:40	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 17:34:46	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:34:46	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 17:34:46	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 17:34:46	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 17:34:52	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:34:52	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 17:34:52	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 17:34:52	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 17:34:58	INFO	testing.py	normalizing images with: zscore
24 Jun 22 17:34:58	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:35:00	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 17:35:02	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 17:35:02	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 17:37:05	INFO	testing.py	train mad (without TTA and regression): 127.1815171702752
24 Jun 22 17:37:05	INFO	testing.py	validation mad (without TTA and regression): 126.95201598735066
24 Jun 22 17:37:05	INFO	testing.py	test mad (without TTA and regression): 131.908203125
24 Jun 22 17:37:05	INFO	testing.py	===== regress correct on raw images =====
24 Jun 22 17:37:05	INFO	testing.py	Linear bias prediction:	slope: -52.4832	intercept: -119.6258	r = -0.5492	p-value = 0.0E+00	std error = 7.1E-01
24 Jun 22 17:37:05	INFO	testing.py	train mad (after regression): 25.970170116583393
24 Jun 22 17:37:05	INFO	testing.py	validation mad (after regression): 26.294327565003513
24 Jun 22 17:37:05	INFO	testing.py	test mad (after regression): 31.7354443359375
24 Jun 22 17:37:05	INFO	testing.py	===== regress correct on raw images and TTA =====
24 Jun 22 17:37:05	INFO	testing.py	Linear bias prediction:	slope: -52.4832	intercept: -119.6258	r = -0.5492	p-value = 0.0E+00	std error = 7.1E-01
24 Jun 22 17:37:05	INFO	testing.py	train mad (after regression and TTA): 25.970167803410096
24 Jun 22 17:37:05	INFO	testing.py	validation mad (after regression and TTA): 27.013754308396656
24 Jun 22 17:37:05	INFO	testing.py	test mad (after regression and TTA): 32.172079172374964
24 Jun 22 17:37:05	INFO	testing.py	saving outputs to output/debug/version_31/predictions
24 Jun 22 17:37:06	INFO	train_model.py	======= END =========
24 Jun 22 17:51:48	INFO	seed.py	Global seed set to 42
24 Jun 22 17:51:48	INFO	datasets.py	found 12610 train images
24 Jun 22 17:51:48	INFO	datasets.py	found 1425 val images
24 Jun 22 17:51:48	INFO	datasets.py	found 200 test images
24 Jun 22 17:51:48	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 17:51:48	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:51:50	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 17:51:52	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 17:51:52	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 17:51:52	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 17:51:52	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:51:52	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 17:51:52	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 17:51:52	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 17:51:52	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 17:51:52	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:51:52	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 17:51:52	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 17:51:52	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 17:51:52	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 17:51:52	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 17:51:52	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 17:51:52	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 17:51:52	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 17:51:52	INFO	cli.py	Output directory set to output/debug/version_32
24 Jun 22 17:51:52	INFO	log.py	Logs saved to run.log
24 Jun 22 17:51:52	INFO	log.py	Core count             = 12
24 Jun 22 17:51:52	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 17:51:52	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 17:51:52	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 17:51:52	INFO	log.py	CUDA version           = 11.3
24 Jun 22 17:51:52	INFO	log.py	CUDA count             = 1
24 Jun 22 17:51:52	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 17:52:02	INFO	train_model.py	========== start training ==========
24 Jun 22 17:52:05	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 17:52:06	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 4.0 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 4.0 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
10 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
11 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
12 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
13 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
14 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
15 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
16 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
17 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
18 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
19 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
20 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
21 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
23 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
24 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
7.2 M     Trainable params
0         Non-trainable params
7.2 M     Total params
14.379    Total estimated model params size (MB)
24 Jun 22 17:53:39	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 38.134
24 Jun 22 17:53:39	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached 38.13387 (best 38.13387), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_32/ckp/best_model.ckpt' as top 1
24 Jun 22 17:53:44	INFO	cli.py	===== Training finished ======
24 Jun 22 17:53:44	INFO	cli.py	Training time : 1.69min for 102 steps of training
24 Jun 22 17:53:44	INFO	cli.py	Training speed: 1.01 steps/second
24 Jun 22 17:53:44	INFO	train_model.py	========== Testing model ==========
24 Jun 22 17:53:44	INFO	cli.py	Using best model
24 Jun 22 17:53:44	INFO	testing.py	====== Testing model =====
24 Jun 22 17:53:44	INFO	testing.py	Starting inference
24 Jun 22 17:53:45	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_32/ckp/best_model.ckpt
24 Jun 22 17:53:45	INFO	testing.py	normalizing images with: zscore
24 Jun 22 17:53:45	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:53:45	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 17:53:45	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 17:53:45	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 17:54:57	INFO	seed.py	Global seed set to 42
24 Jun 22 17:54:57	INFO	datasets.py	found 12610 train images
24 Jun 22 17:54:57	INFO	datasets.py	found 1425 val images
24 Jun 22 17:54:57	INFO	datasets.py	found 200 test images
24 Jun 22 17:54:57	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 17:54:57	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:54:59	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 17:55:01	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 17:55:01	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 17:55:01	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 17:55:01	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:55:01	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 17:55:01	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 17:55:01	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 17:55:01	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 17:55:22	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 17:55:22	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 17:55:22	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 17:55:22	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 17:55:50	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 17:55:50	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 17:55:50	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 17:55:50	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 17:55:50	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 17:55:50	INFO	cli.py	Output directory set to output/debug/version_33
24 Jun 22 17:55:50	INFO	log.py	Logs saved to run.log
24 Jun 22 17:55:50	INFO	log.py	Core count             = 12
24 Jun 22 17:55:50	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 17:55:50	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 17:55:50	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 17:55:50	INFO	log.py	CUDA version           = 11.3
24 Jun 22 17:55:50	INFO	log.py	CUDA count             = 1
24 Jun 22 17:55:50	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 17:56:38	INFO	train_model.py	========== start training ==========
24 Jun 22 17:56:42	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 17:56:42	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 4.0 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 4.0 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
10 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
11 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
12 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
13 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
14 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
15 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
16 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
17 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
18 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
19 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
20 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
21 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
23 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
24 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
7.2 M     Trainable params
0         Non-trainable params
7.2 M     Total params
14.379    Total estimated model params size (MB)
24 Jun 22 17:59:29	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 38.134
24 Jun 22 17:59:29	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached 38.13387 (best 38.13387), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_33/ckp/best_model.ckpt' as top 1
24 Jun 22 18:00:56	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 1.851 >= min_delta = 0.0. New best score: 36.283
24 Jun 22 18:00:56	INFO	model_checkpoint.py	Epoch 1, global step 200: 'Step-wise/val_mad' reached 36.28289 (best 36.28289), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_33/ckp/best_model.ckpt' as top 1
24 Jun 22 18:02:24	INFO	model_checkpoint.py	Epoch 2, global step 300: 'Step-wise/val_mad' was not in top 1
24 Jun 22 18:03:58	INFO	cli.py	===== Training finished ======
24 Jun 22 18:03:58	INFO	cli.py	Training time : 7.30min for 336 steps of training
24 Jun 22 18:03:58	INFO	cli.py	Training speed: 0.77 steps/second
24 Jun 22 18:03:58	INFO	train_model.py	========== Testing model ==========
24 Jun 22 18:03:58	INFO	cli.py	Using best model
24 Jun 22 18:03:58	INFO	testing.py	====== Testing model =====
24 Jun 22 18:03:58	INFO	testing.py	Starting inference
24 Jun 22 18:03:58	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_33/ckp/best_model.ckpt
24 Jun 22 18:03:58	INFO	testing.py	normalizing images with: zscore
24 Jun 22 18:03:58	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:03:59	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:03:59	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:03:59	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:05:43	INFO	seed.py	Global seed set to 42
24 Jun 22 18:05:43	INFO	datasets.py	found 12610 train images
24 Jun 22 18:05:43	INFO	datasets.py	found 1425 val images
24 Jun 22 18:05:43	INFO	datasets.py	found 200 test images
24 Jun 22 18:05:43	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 18:05:43	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:05:45	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 18:05:47	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 18:05:47	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 18:05:47	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 18:05:47	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:05:47	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:05:47	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:05:47	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:05:47	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 18:05:47	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:05:47	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 18:05:47	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 18:05:47	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 18:05:48	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 18:05:48	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 18:05:48	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 18:05:48	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 18:05:48	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 18:05:48	INFO	cli.py	Output directory set to output/debug/version_34
24 Jun 22 18:05:48	INFO	log.py	Logs saved to run.log
24 Jun 22 18:05:48	INFO	log.py	Core count             = 12
24 Jun 22 18:05:48	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 18:05:48	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 18:05:48	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 18:05:48	INFO	log.py	CUDA version           = 11.3
24 Jun 22 18:05:48	INFO	log.py	CUDA count             = 1
24 Jun 22 18:05:48	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 18:05:59	INFO	train_model.py	========== start training ==========
24 Jun 22 18:06:01	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 18:06:02	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 4.0 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 4.0 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
10 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
11 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
12 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
13 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
14 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
15 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
16 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
17 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
18 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
19 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
20 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
21 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
23 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
24 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
7.2 M     Trainable params
0         Non-trainable params
7.2 M     Total params
14.379    Total estimated model params size (MB)
24 Jun 22 18:07:35	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 38.134
24 Jun 22 18:07:35	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached 38.13387 (best 38.13387), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_34/ckp/best_model.ckpt' as top 1
24 Jun 22 18:07:40	INFO	cli.py	===== Training finished ======
24 Jun 22 18:07:40	INFO	cli.py	Training time : 1.69min for 102 steps of training
24 Jun 22 18:07:40	INFO	cli.py	Training speed: 1.01 steps/second
24 Jun 22 18:07:40	INFO	train_model.py	========== Testing model ==========
24 Jun 22 18:08:09	INFO	cli.py	Using best model
24 Jun 22 18:21:08	INFO	testing.py	====== Testing model =====
24 Jun 22 18:21:08	INFO	testing.py	Starting inference
24 Jun 22 18:29:30	INFO	seed.py	Global seed set to 42
24 Jun 22 18:29:30	INFO	datasets.py	found 12610 train images
24 Jun 22 18:29:30	INFO	datasets.py	found 1425 val images
24 Jun 22 18:29:30	INFO	datasets.py	found 200 test images
24 Jun 22 18:29:30	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 18:29:30	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:29:32	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 18:29:33	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 18:29:33	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 18:29:33	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 18:29:33	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:29:33	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:29:34	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:29:34	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:29:34	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 18:29:34	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:29:34	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 18:29:34	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 18:29:34	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 18:32:03	INFO	seed.py	Global seed set to 42
24 Jun 22 18:32:03	INFO	datasets.py	found 12610 train images
24 Jun 22 18:32:03	INFO	datasets.py	found 1425 val images
24 Jun 22 18:32:03	INFO	datasets.py	found 200 test images
24 Jun 22 18:32:03	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 18:32:03	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:32:05	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 18:32:06	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 18:32:06	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 18:32:06	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 18:32:06	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:32:07	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:32:07	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:32:07	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:32:07	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 18:32:07	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:32:07	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 18:32:07	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 18:32:07	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 18:32:07	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 18:32:07	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 18:32:07	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 18:32:07	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 18:32:07	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 18:32:07	INFO	cli.py	Output directory set to output/debug/version_35
24 Jun 22 18:32:07	INFO	log.py	Logs saved to run.log
24 Jun 22 18:32:07	INFO	log.py	Core count             = 12
24 Jun 22 18:32:07	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 18:32:07	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 18:32:07	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 18:32:07	INFO	log.py	CUDA version           = 11.3
24 Jun 22 18:32:07	INFO	log.py	CUDA count             = 1
24 Jun 22 18:32:07	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 18:32:16	INFO	train_model.py	========== start training ==========
24 Jun 22 18:32:59	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 18:32:59	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 4.0 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 4.0 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
10 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
11 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
12 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
13 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
14 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
15 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
16 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
17 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
18 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
19 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
20 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
21 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
23 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
24 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
7.2 M     Trainable params
4         Non-trainable params
7.2 M     Total params
14.379    Total estimated model params size (MB)
24 Jun 22 18:33:56	INFO	seed.py	Global seed set to 42
24 Jun 22 18:33:56	INFO	datasets.py	found 12610 train images
24 Jun 22 18:33:56	INFO	datasets.py	found 1425 val images
24 Jun 22 18:33:56	INFO	datasets.py	found 200 test images
24 Jun 22 18:33:56	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 18:33:56	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:33:57	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 18:33:59	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 18:33:59	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 18:33:59	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 18:33:59	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:33:59	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:34:00	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:34:00	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:34:00	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 18:34:00	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:34:00	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 18:34:00	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 18:34:00	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 18:34:00	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 18:34:00	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 18:34:00	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 18:34:00	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 18:34:00	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 18:34:00	INFO	cli.py	Output directory set to output/debug/version_36
24 Jun 22 18:34:00	INFO	log.py	Logs saved to run.log
24 Jun 22 18:34:00	INFO	log.py	Core count             = 12
24 Jun 22 18:34:00	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 18:34:00	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 18:34:00	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 18:34:00	INFO	log.py	CUDA version           = 11.3
24 Jun 22 18:34:00	INFO	log.py	CUDA count             = 1
24 Jun 22 18:34:00	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 18:34:12	INFO	train_model.py	========== start training ==========
24 Jun 22 18:34:14	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 18:34:14	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 4.0 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 4.0 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
10 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
11 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
12 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
13 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
14 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
15 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
16 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
17 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
18 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
19 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
20 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
21 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
23 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
24 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
7.2 M     Trainable params
4         Non-trainable params
7.2 M     Total params
14.379    Total estimated model params size (MB)
24 Jun 22 18:39:40	INFO	seed.py	Global seed set to 42
24 Jun 22 18:39:40	INFO	datasets.py	found 12610 train images
24 Jun 22 18:39:40	INFO	datasets.py	found 1425 val images
24 Jun 22 18:39:40	INFO	datasets.py	found 200 test images
24 Jun 22 18:39:40	INFO	datasets.py	========== Setting up train data ==========
24 Jun 22 18:39:40	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:39:41	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 12584 / 12610
24 Jun 22 18:39:43	INFO	datasets.py	Number of masks available at ../data/masks/unet : 12587 / 12610
24 Jun 22 18:39:43	INFO	datasets.py	Number of masks available from all sources combined : 12609 / 12610
24 Jun 22 18:39:43	INFO	datasets.py	========== Setting up validation data ==========
24 Jun 22 18:39:43	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:39:43	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:39:43	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:39:43	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:39:43	INFO	datasets.py	========== Setting up test data ==========
24 Jun 22 18:39:43	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:39:43	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
24 Jun 22 18:39:43	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 200
24 Jun 22 18:39:43	INFO	datasets.py	Number of masks available from all sources combined : 200 / 200
24 Jun 22 18:39:44	INFO	accelerator_connector.py	Using 16bit native Automatic Mixed Precision (AMP)
24 Jun 22 18:39:44	INFO	trainer.py	GPU available: True, used: True
24 Jun 22 18:39:44	INFO	trainer.py	TPU available: False, using: 0 TPU cores
24 Jun 22 18:39:44	INFO	trainer.py	IPU available: False, using: 0 IPUs
24 Jun 22 18:39:44	INFO	trainer.py	HPU available: False, using: 0 HPUs
24 Jun 22 18:39:44	INFO	cli.py	Output directory set to output/debug/version_37
24 Jun 22 18:39:44	INFO	log.py	Logs saved to run.log
24 Jun 22 18:39:44	INFO	log.py	Core count             = 12
24 Jun 22 18:39:44	INFO	log.py	Python version         = 3.9.7 (default, Sep 16 2021, 13:09:58) 
[GCC 7.5.0]
24 Jun 22 18:39:44	INFO	log.py	Pytorch version        = 1.10.2+cu113
24 Jun 22 18:39:44	INFO	log.py	Albumentations version = 1.1.0
24 Jun 22 18:39:44	INFO	log.py	CUDA version           = 11.3
24 Jun 22 18:39:44	INFO	log.py	CUDA count             = 1
24 Jun 22 18:39:44	INFO	log.py	CUDA name              = NVIDIA GeForce GTX 1080 Ti
24 Jun 22 18:39:53	INFO	train_model.py	========== start training ==========
24 Jun 22 18:39:57	INFO	gpu.py	LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
24 Jun 22 18:39:57	INFO	model_summary.py	
   | Name                       | Type                    | Params | In sizes            | Out sizes        
------------------------------------------------------------------------------------------------------------------
0  | backbone                   | EfficientnetBackbone    | 4.0 M  | ?                   | ?                
1  | backbone.base              | EfficientNet            | 4.0 M  | ?                   | ?                
2  | backbone.base._conv_stem   | Conv2dStaticSamePadding | 288    | [4, 1, 512, 512]    | [4, 32, 256, 256]
3  | backbone.base._bn0         | BatchNorm2d             | 64     | [4, 32, 256, 256]   | [4, 32, 256, 256]
4  | backbone.base._blocks      | ModuleList              | 3.6 M  | ?                   | ?                
5  | backbone.base._conv_head   | Conv2dStaticSamePadding | 409 K  | [4, 320, 16, 16]    | [4, 1280, 16, 16]
6  | backbone.base._bn1         | BatchNorm2d             | 2.6 K  | [4, 1280, 16, 16]   | [4, 1280, 16, 16]
7  | backbone.base._avg_pooling | AdaptiveAvgPool2d       | 0      | ?                   | ?                
8  | backbone.base._dropout     | Dropout                 | 0      | ?                   | ?                
9  | backbone.base._swish       | MemoryEfficientSwish    | 0      | [4, 32, 256, 256]   | [4, 32, 256, 256]
10 | backbone.act               | MemoryEfficientSwish    | 0      | ?                   | ?                
11 | dense                      | DenseNetwork            | 3.2 M  | [[4, 1280], [4, 1]] | [[4, 1], [4, 1]] 
12 | dense.dropout              | Dropout                 | 0      | [4, 1024]           | [4, 1024]        
13 | dense.fc_gender_in         | Linear                  | 64     | [4, 1]              | [4, 32]          
14 | dense.act                  | ReLU                    | 0      | [4, 32]             | [4, 32]          
15 | dense.dense_blocks         | ModuleList              | 3.2 M  | ?                   | ?                
16 | dense.dense_blocks.0       | Linear                  | 1.3 M  | [4, 1312]           | [4, 1024]        
17 | dense.dense_blocks.1       | Linear                  | 1.0 M  | [4, 1024]           | [4, 1024]        
18 | dense.dense_blocks.2       | Linear                  | 524 K  | [4, 1024]           | [4, 512]         
19 | dense.dense_blocks.3       | Linear                  | 262 K  | [4, 512]            | [4, 512]         
20 | dense.fc_boneage           | Linear                  | 513    | [4, 512]            | [4, 1]           
21 | dense.fc_sex               | Linear                  | 513    | [4, 512]            | [4, 1]           
22 | loss                       | MultiTaskLoss           | 2      | ?                   | ?                
23 | loss.age_loss              | MSELoss                 | 0      | ?                   | ?                
24 | loss.sex_loss              | BCEWithLogitsLoss       | 0      | ?                   | ?                
------------------------------------------------------------------------------------------------------------------
7.2 M     Trainable params
0         Non-trainable params
7.2 M     Total params
14.379    Total estimated model params size (MB)
24 Jun 22 18:41:31	INFO	early_stopping.py	Metric Step-wise/val_mad improved. New best score: 38.134
24 Jun 22 18:41:31	INFO	model_checkpoint.py	Epoch 0, global step 100: 'Step-wise/val_mad' reached 38.13387 (best 38.13387), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_37/ckp/best_model.ckpt' as top 1
24 Jun 22 18:42:58	INFO	early_stopping.py	Metric Step-wise/val_mad improved by 1.731 >= min_delta = 0.0. New best score: 36.402
24 Jun 22 18:42:58	INFO	model_checkpoint.py	Epoch 1, global step 200: 'Step-wise/val_mad' reached 36.40238 (best 36.40238), saving model to '/home/rassman/bone2gene/bone-age/output/debug/version_37/ckp/best_model.ckpt' as top 1
24 Jun 22 18:43:03	INFO	cli.py	===== Training finished ======
24 Jun 22 18:43:03	INFO	cli.py	Training time : 3.15min for 200 steps of training
24 Jun 22 18:43:03	INFO	cli.py	Training speed: 1.06 steps/second
24 Jun 22 18:43:03	INFO	train_model.py	========== Testing model ==========
24 Jun 22 18:43:13	INFO	cli.py	Using best model
24 Jun 22 18:43:17	INFO	testing.py	====== Testing model =====
24 Jun 22 18:43:17	INFO	testing.py	Starting inference
24 Jun 22 18:43:46	INFO	testing.py	Load model from /home/rassman/bone2gene/bone-age/output/debug/version_37/ckp/best_model.ckpt
24 Jun 22 18:43:46	INFO	testing.py	normalizing images with: zscore
24 Jun 22 18:43:46	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:43:47	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:43:47	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:43:47	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:44:19	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:44:20	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:44:20	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:44:20	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:44:41	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:44:41	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:44:41	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:44:41	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:45:01	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:45:01	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:45:01	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:45:01	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:45:22	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:45:22	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:45:22	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:45:22	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:45:39	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:45:40	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:45:40	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:45:40	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:45:57	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:45:57	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:45:58	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:45:58	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:46:18	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:46:18	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:46:18	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:46:18	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:46:39	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:46:39	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:46:39	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:46:39	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:46:59	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:46:59	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 1423 / 1425
24 Jun 22 18:47:00	INFO	datasets.py	Number of masks available at ../data/masks/unet : 0 / 1425
24 Jun 22 18:47:00	INFO	datasets.py	Number of masks available from all sources combined : 1423 / 1425
24 Jun 22 18:47:20	INFO	testing.py	normalizing images with: zscore
24 Jun 22 18:47:20	INFO	datasets.py	Used masking dirs : ['../data/masks/tensormask', '../data/masks/unet']
24 Jun 22 18:47:20	INFO	datasets.py	Number of masks available at ../data/masks/tensormask : 200 / 200
